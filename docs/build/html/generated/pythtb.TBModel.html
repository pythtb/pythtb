
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pythtb.TBModel &#8212; PythTB Docs</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=7f41d439"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=cbcfbdad"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = "div.nbinput"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'generated/pythtb.TBModel';</script>
    <script defer="defer" src="../_static/custom-icons.js?v=7518156e"></script>
    <script src="https://unpkg.com/thebe@latest/lib/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pythtb.WFArray" href="pythtb.WFArray.html" />
    <link rel="prev" title="Usage" href="../usage.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">PythTB Docs</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Install
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../CHANGELOG.html">
    Changelog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../formalism.html">
    Formalism
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../resources.html">
    Resources
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../citation.html">
    Citation
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/treycole/pythtb" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/pythtb/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Install
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../CHANGELOG.html">
    Changelog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../formalism.html">
    Formalism
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../resources.html">
    Resources
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../citation.html">
    Citation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/treycole/pythtb" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/pythtb/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">PythTB Classes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">pythtb.TBModel</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.WFArray.html">pythtb.WFArray</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.W90.html">pythtb.W90</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.Wannier.html">pythtb.Wannier</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.Bloch.html">pythtb.Bloch</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PythTB Plotting</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pythtb.plotting.plot_bands.html">pythtb.plotting.plot_bands</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.plotting.plot_tb_model.html">pythtb.plotting.plot_tb_model</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.plotting.plot_tb_model_3d.html">pythtb.plotting.plot_tb_model_3d</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PythTB Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.ssh.html">pythtb.models.ssh</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.checkerboard.html">pythtb.models.checkerboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.graphene.html">pythtb.models.graphene</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.haldane.html">pythtb.models.haldane</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.kane_mele.html">pythtb.models.kane_mele</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.fu_kane_mele.html">pythtb.models.fu_kane_mele</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../usage.html" class="nav-link">Usage</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">pythtb.TBModel</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pythtb-tbmodel">
<h1>pythtb.TBModel<a class="headerlink" href="#pythtb-tbmodel" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pythtb.TBModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pythtb.</span></span><span class="sig-name descname"><span class="pre">TBModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel" title="Link to this definition">#</a></dt>
<dd><p>Tight-binding model constructor.</p>
<p>This class contains the tight-binding model information.
It is designed to handle various aspects of tight-binding models, including the lattice structure,
orbital positions, and periodic boundary conditions. It will also provide methods for constructing
the Hamiltonian matrix and diagonalizing the tight-binding model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimensionality of reciprocal space, i.e., specifies how
many directions are considered to be periodic.</p></li>
<li><p><strong>dim_r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Dimensionality of real space, i.e., specifies how many
real space lattice vectors there are and how many coordinates are
needed to specify the orbital coordinates.</p></li>
<li><p><strong>lat</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Array containing lattice vectors in Cartesian coordinates
(in arbitrary units). By default, lattice vectors are an identity matrix.</p></li>
<li><p><strong>orb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>array_like</em><em>, </em><em>optional</em>) – Array containing reduced coordinates of all
tight-binding orbitals. If <code class="docutils literal notranslate"><span class="pre">orb</span></code> is an integer code will assume
that there are these many orbitals all at the origin of the unit cell.
By default <code class="docutils literal notranslate"><span class="pre">orb=1</span></code> and the code will assume a single orbital at the origin.</p></li>
<li><p><strong>per</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>Specifies the indices of lattice vectors which are considered to be periodic.
By default, all lattice vectors are assumed to be periodic. If <code class="docutils literal notranslate"><span class="pre">dim_k</span></code> is smaller than <code class="docutils literal notranslate"><span class="pre">dim_r</span></code>,
then by default the first <code class="docutils literal notranslate"><span class="pre">dim_k</span></code> vectors are considered to be periodic.</p>
<p>In the example below, only the vector <code class="docutils literal notranslate"><span class="pre">[0.0,2.0]</span></code> is considered to be periodic
(since <code class="docutils literal notranslate"><span class="pre">per=[1]</span></code>).</p>
</p></li>
<li><p><strong>nspin</strong> (<em>{1</em><em>, </em><em>2}</em><em>, </em><em>optional</em>) – Number of explicit spin components assumed for each
orbital in <code class="docutils literal notranslate"><span class="pre">orb</span></code>. Allowed values of <code class="docutils literal notranslate"><span class="pre">nspin</span></code> are <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">2</span></code>. If
<code class="docutils literal notranslate"><span class="pre">nspin=1</span></code> then the model is spinless, if <code class="docutils literal notranslate"><span class="pre">nspin=2</span></code> then it
is explicitly a spinfull model and each orbital is assumed to
have two spin components. Default value of this parameter is
<code class="docutils literal notranslate"><span class="pre">nspin=1</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Parameter <code class="docutils literal notranslate"><span class="pre">dim_r</span></code> can be larger than <code class="docutils literal notranslate"><span class="pre">dim_k</span></code>! For example,
a polymer is a three-dimensional molecule (one needs three
coordinates to specify orbital positions), but it is periodic
along only one direction. For a polymer, therefore, we should
have <code class="docutils literal notranslate"><span class="pre">dim_k=1</span></code> and <code class="docutils literal notranslate"><span class="pre">dim_r=3</span></code>. See the <a class="reference internal" href="../examples_ipynb/trestle.html#trestle-nb"><span class="std std-ref">Ribbon geometry</span></a>
or <a class="reference internal" href="../examples_ipynb/buckled_layer.html#buckled-layer-nb"><span class="std std-ref">Slab geometry</span></a> examples.</p>
<p class="rubric">Examples</p>
<p>Creates model that is two-dimensional in real space but only
one-dimensional in reciprocal space. The first lattice vector has coordinates
<code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">1/2]</span></code> while the second  one has coordinates <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">2]</span></code>.
The second lattice vector is chosen to be periodic (since <code class="docutils literal notranslate"><span class="pre">per=[1]</span></code>).
Three orbital coordinates are specified in reduced units. The first orbital
is defined with reduced coordinates <code class="docutils literal notranslate"><span class="pre">[0.2,</span> <span class="pre">0.3]</span></code>. Its Cartesian coordinates
are therefore 0.2 times the first lattice vector plus 0.3 times the second lattice
vector.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">pythtb</span><span class="w"> </span><span class="kn">import</span> <span class="n">TBModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tb</span> <span class="o">=</span> <span class="n">TBModel</span><span class="p">(</span>
<span class="gp">... </span>       <span class="n">dim_k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim_r</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">lat</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
<span class="gp">... </span>       <span class="n">orb</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]],</span>
<span class="gp">... </span>       <span class="n">per</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">... </span>   <span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tb</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim_k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>dim_r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>nspin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__delattr__</span></code>(name, /)</p></td>
<td><p>Implement delattr(self, name).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__dir__</span></code>()</p></td>
<td><p>Default dir() implementation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__eq__</span></code>(other)</p></td>
<td><p>Compare two TBModel objects for equality.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__format__</span></code>(format_spec, /)</p></td>
<td><p>Default object formatter.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__ge__</span></code>(value, /)</p></td>
<td><p>Return self&gt;=value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getattribute__</span></code>(name, /)</p></td>
<td><p>Return getattr(self, name).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getstate__</span></code>()</p></td>
<td><p>Helper for pickle.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__gt__</span></code>(value, /)</p></td>
<td><p>Return self&gt;value.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.__init__" title="pythtb.TBModel.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(dim_k, dim_r[, lat, orb, per, nspin])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init_subclass__</span></code></p></td>
<td><p>This method is called when a class is subclassed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__le__</span></code>(value, /)</p></td>
<td><p>Return self&lt;=value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__lt__</span></code>(value, /)</p></td>
<td><p>Return self&lt;value.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__ne__</span></code>(value, /)</p></td>
<td><p>Return self!=value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__new__</span></code>(*args, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__reduce__</span></code>()</p></td>
<td><p>Helper for pickle.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__reduce_ex__</span></code>(protocol, /)</p></td>
<td><p>Helper for pickle.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__repr__</span></code>()</p></td>
<td><p>Return a string representation of the <code class="docutils literal notranslate"><span class="pre">TBModel</span></code> object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__setattr__</span></code>(name, value, /)</p></td>
<td><p>Implement setattr(self, name, value).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__sizeof__</span></code>()</p></td>
<td><p>Size of object in memory, in bytes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__str__</span></code>()</p></td>
<td><p>Return a string representation of the <code class="docutils literal notranslate"><span class="pre">TBModel</span></code> object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__subclasshook__</span></code></p></td>
<td><p>Abstract classes can override this to customize issubclass().</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_get_periodic_H</span></code>(H_flat, k_vals)</p></td>
<td><p>Applies periodic boundary conditions to the Hamiltonian.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_shift_to_home</span></code>([to_home_warning])</p></td>
<td><p>Shifts orbital coordinates (along periodic directions) to the home unit cell.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_sol_ham</span></code>(ham[, return_eigvecs, keep_spin_ax])</p></td>
<td><p>Solves Hamiltonian and returns eigenvectors, eigenvalues</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_val_to_block</span></code>(val)</p></td>
<td><p>Convert input value to appropriate matrix block for onsite or hopping.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.add_orb" title="pythtb.TBModel.add_orb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_orb</span></code></a>(coord)</p></td>
<td><p>Adds a new orbital to the model with the specified coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.berry_curvature" title="pythtb.TBModel.berry_curvature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">berry_curvature</span></code></a>(k_pts[, evals, evecs, ...])</p></td>
<td><p>Compute the Berry curvature at a list of k-points.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.change_nonperiodic_vector" title="pythtb.TBModel.change_nonperiodic_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">change_nonperiodic_vector</span></code></a>(np_dir[, ...])</p></td>
<td><p>Change non-periodic lattice vector</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.chern" title="pythtb.TBModel.chern"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chern</span></code></a>([occ_idxs, dirs, nk])</p></td>
<td><p>Computes Chern number for occupied manifold.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.clear_hoppings" title="pythtb.TBModel.clear_hoppings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_hoppings</span></code></a>()</p></td>
<td><p>Clear all hoppings in the model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.clear_onsite" title="pythtb.TBModel.clear_onsite"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clear_onsite</span></code></a>()</p></td>
<td><p>Clear all on-site energies in the model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.copy" title="pythtb.TBModel.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Return a deep copy of the TBModel object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.cut_piece" title="pythtb.TBModel.cut_piece"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cut_piece</span></code></a>(num, fin_dir[, glue_edgs])</p></td>
<td><p>Cut a (d-1)-dimensional piece out of a d-dimensional tight-binding model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.display" title="pythtb.TBModel.display"><code class="xref py py-obj docutils literal notranslate"><span class="pre">display</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.get_k_mesh" title="pythtb.TBModel.get_k_mesh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_k_mesh</span></code></a>([flat])</p></td>
<td><p>Return the k-space mesh.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.get_lat" title="pythtb.TBModel.get_lat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_lat</span></code></a>()</p></td>
<td><p>Return lattice vectors in Cartesian coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.get_num_orbitals" title="pythtb.TBModel.get_num_orbitals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_num_orbitals</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.get_orb" title="pythtb.TBModel.get_orb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_orb</span></code></a>([cartesian])</p></td>
<td><p>Return orbital positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.get_recip_lat" title="pythtb.TBModel.get_recip_lat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_recip_lat</span></code></a>()</p></td>
<td><p>Reciprocal lattice vectors in Cartesian coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.get_recip_vol" title="pythtb.TBModel.get_recip_vol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_recip_vol</span></code></a>()</p></td>
<td><p>Return the volume of the reciprocal lattice.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.get_velocity" title="pythtb.TBModel.get_velocity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_velocity</span></code></a>(k_pts[, cartesian])</p></td>
<td><p>Generate the velocity operator</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.hamiltonian" title="pythtb.TBModel.hamiltonian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hamiltonian</span></code></a>([k_pts])</p></td>
<td><p>Generate the Bloch Hamiltonian for an array of k-points in reduced coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.ignore_position_operator_offdiagonal" title="pythtb.TBModel.ignore_position_operator_offdiagonal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ignore_position_operator_offdiagonal</span></code></a>()</p></td>
<td><p>Set flag to ignore off-diagonal elements of the position operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.k_path" title="pythtb.TBModel.k_path"><code class="xref py py-obj docutils literal notranslate"><span class="pre">k_path</span></code></a>(kpts, nk[, report])</p></td>
<td><p>Interpolates a path in reciprocal space.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.k_uniform_mesh" title="pythtb.TBModel.k_uniform_mesh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">k_uniform_mesh</span></code></a>(mesh_size)</p></td>
<td><p>Uniform grid of k-points in reduced coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.make_supercell" title="pythtb.TBModel.make_supercell"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_supercell</span></code></a>(sc_red_lat[, ...])</p></td>
<td><p>Make model on a super-cell.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.plot_bands" title="pythtb.TBModel.plot_bands"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_bands</span></code></a>(k_path[, nk, k_label, ...])</p></td>
<td><p>Plot the band structure along a specified path in k-space.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.position_expectation" title="pythtb.TBModel.position_expectation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">position_expectation</span></code></a>(evec, dir)</p></td>
<td><p>Returns diagonal matrix elements of the position operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.position_hwf" title="pythtb.TBModel.position_hwf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">position_hwf</span></code></a>(evec, dir[, hwf_evec, basis])</p></td>
<td><p>Eigenvalues and eigenvectors of the position operator</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.position_matrix" title="pythtb.TBModel.position_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">position_matrix</span></code></a>(evec, dir)</p></td>
<td><p>Position operator matrix elements</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.reduce_dim" title="pythtb.TBModel.reduce_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reduce_dim</span></code></a>(remove_k, value_k)</p></td>
<td><p>Reduces dimensionality of the model by taking a reciprocal-space slice</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.remove_orb" title="pythtb.TBModel.remove_orb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_orb</span></code></a>(to_remove)</p></td>
<td><p>Removes specified orbitals from the model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.report" title="pythtb.TBModel.report"><code class="xref py py-obj docutils literal notranslate"><span class="pre">report</span></code></a>([show, short])</p></td>
<td><p>Print or return a report about the tight-binding model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.set_hop" title="pythtb.TBModel.set_hop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_hop</span></code></a>(hop_amp, ind_i, ind_j[, ind_R, ...])</p></td>
<td><p>Define hopping parameters between tight-binding orbitals.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.set_k_mesh" title="pythtb.TBModel.set_k_mesh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_k_mesh</span></code></a>(nks)</p></td>
<td><p>Set up a uniform k-space mesh for the model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.set_onsite" title="pythtb.TBModel.set_onsite"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_onsite</span></code></a>(onsite_en[, ind_i, mode])</p></td>
<td><p>Define on-site energies for tight-binding orbitals.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.solve_all" title="pythtb.TBModel.solve_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_all</span></code></a>([k_list, eig_vectors])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.solve_ham" title="pythtb.TBModel.solve_ham"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_ham</span></code></a>([k_list, return_eigvecs, keep_spin_ax])</p></td>
<td><p>Diagonalize the Hamiltonian</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.solve_one" title="pythtb.TBModel.solve_one"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_one</span></code></a>([k_list, eig_vectors])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.visualize" title="pythtb.TBModel.visualize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">visualize</span></code></a>([proj_plane, eig_dr, ...])</p></td>
<td><p>Visualizes the tight-binding model geometry.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.visualize_3d" title="pythtb.TBModel.visualize_3d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">visualize_3d</span></code></a>([eig_dr, draw_hoppings, ...])</p></td>
<td><p>Visualize a 3D tight-binding model using <code class="docutils literal notranslate"><span class="pre">Plotly</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Attributes</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__annotations__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__dict__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__doc__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__hash__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__module__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__weakref__</span></code></p></td>
<td><p>list of weak references to the object</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.assume_position_operator_diagonal" title="pythtb.TBModel.assume_position_operator_diagonal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assume_position_operator_diagonal</span></code></a></p></td>
<td><p>Is the position operator is diagonal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.dim_k" title="pythtb.TBModel.dim_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dim_k</span></code></a></p></td>
<td><p>The dimensionality of reciprocal space (periodic directions).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.dim_r" title="pythtb.TBModel.dim_r"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dim_r</span></code></a></p></td>
<td><p>The dimensionality of real space.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.hoppings" title="pythtb.TBModel.hoppings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hoppings</span></code></a></p></td>
<td><p>List of hopping dictionaries for the model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.lat_vecs" title="pythtb.TBModel.lat_vecs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lat_vecs</span></code></a></p></td>
<td><p>Lattice vectors in Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(dim_r,</span> <span class="pre">dim_r)</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.norb" title="pythtb.TBModel.norb"><code class="xref py py-obj docutils literal notranslate"><span class="pre">norb</span></code></a></p></td>
<td><p>The number of tight-binding orbitals in the model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.nspin" title="pythtb.TBModel.nspin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nspin</span></code></a></p></td>
<td><p>The number of spin components.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.nstate" title="pythtb.TBModel.nstate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nstate</span></code></a></p></td>
<td><p>The number of electronic states in the model is <code class="docutils literal notranslate"><span class="pre">norb</span> <span class="pre">*</span> <span class="pre">nspin</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.orb_vecs" title="pythtb.TBModel.orb_vecs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">orb_vecs</span></code></a></p></td>
<td><p>Orbital vectors in reduced coordinates with shape <code class="docutils literal notranslate"><span class="pre">(norb,</span> <span class="pre">dim_r)</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.TBModel.per" title="pythtb.TBModel.per"><code class="xref py py-obj docutils literal notranslate"><span class="pre">per</span></code></a></p></td>
<td><p>Periodic directions as a list of indices.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.TBModel.site_energies" title="pythtb.TBModel.site_energies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">site_energies</span></code></a></p></td>
<td><p>On-site energies for each orbital.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.display">
<span class="sig-name descname"><span class="pre">display</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.display"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.display" title="Link to this definition">#</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.0.0: </span><cite>display</cite> has been deprecated, it is recommended to use <cite>print(model)</cite> or <cite>model.report(show=True)</cite> instead.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.report">
<span class="sig-name descname"><span class="pre">report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">short</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.report" title="Link to this definition">#</a></dt>
<dd><p>Print or return a report about the tight-binding model.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0: </span>The <cite>short</cite> parameter was added to control the verbosity of the report.
The <cite>show</cite> parameter was added to control whether to print the report or return it as a string.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, prints the report to stdout. If False, returns the report as a string.</p></li>
<li><p><strong>short</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, print only a short summary. If False, print full details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the report string if <cite>show</cite> is False, otherwise prints and returns None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a> or None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The report includes lattice vectors, orbital positions, site energies, hoppings, and hopping distances.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.TBModel.dim_r">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim_r</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#pythtb.TBModel.dim_r" title="Link to this definition">#</a></dt>
<dd><p>The dimensionality of real space.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.TBModel.dim_k">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#pythtb.TBModel.dim_k" title="Link to this definition">#</a></dt>
<dd><p>The dimensionality of reciprocal space (periodic directions).</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.TBModel.nspin">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nspin</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#pythtb.TBModel.nspin" title="Link to this definition">#</a></dt>
<dd><p>The number of spin components.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.TBModel.per">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">per</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pythtb.TBModel.per" title="Link to this definition">#</a></dt>
<dd><p>Periodic directions as a list of indices.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<p>Each index corresponds to a lattice vector in the model.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.TBModel.norb">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">norb</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#pythtb.TBModel.norb" title="Link to this definition">#</a></dt>
<dd><p>The number of tight-binding orbitals in the model.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.TBModel.nstate">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nstate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><a class="headerlink" href="#pythtb.TBModel.nstate" title="Link to this definition">#</a></dt>
<dd><p>The number of electronic states in the model is <code class="docutils literal notranslate"><span class="pre">norb</span> <span class="pre">*</span> <span class="pre">nspin</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.TBModel.lat_vecs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lat_vecs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#pythtb.TBModel.lat_vecs" title="Link to this definition">#</a></dt>
<dd><p>Lattice vectors in Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(dim_r,</span> <span class="pre">dim_r)</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.TBModel.orb_vecs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">orb_vecs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#pythtb.TBModel.orb_vecs" title="Link to this definition">#</a></dt>
<dd><p>Orbital vectors in reduced coordinates with shape <code class="docutils literal notranslate"><span class="pre">(norb,</span> <span class="pre">dim_r)</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.TBModel.site_energies">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">site_energies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#pythtb.TBModel.site_energies" title="Link to this definition">#</a></dt>
<dd><p>On-site energies for each orbital.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<p>Shape is <code class="docutils literal notranslate"><span class="pre">(norb,)</span></code> for spinless models, <code class="docutils literal notranslate"><span class="pre">(norb,</span> <span class="pre">2,</span> <span class="pre">2)</span></code> for spinful models.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.TBModel.hoppings">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">hoppings</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#pythtb.TBModel.hoppings" title="Link to this definition">#</a></dt>
<dd><p>List of hopping dictionaries for the model.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<dl class="simple">
<dt>Each hopping is represented as a dictionary with keys:</dt><dd><ul class="simple">
<li><p>‘amplitude’: hopping amplitude (complex or matrix)</p></li>
<li><p>‘from_orbital’: index of starting orbital</p></li>
<li><p>‘to_orbital’: index of ending orbital</p></li>
<li><p>‘lattice_vector’: (optional) lattice vector displacement</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.TBModel.assume_position_operator_diagonal">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">assume_position_operator_diagonal</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#pythtb.TBModel.assume_position_operator_diagonal" title="Link to this definition">#</a></dt>
<dd><p>Is the position operator is diagonal.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.copy" title="Link to this definition">#</a></dt>
<dd><p>Return a deep copy of the TBModel object.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A deep copy of the model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#pythtb.TBModel" title="pythtb.TBModel">TBModel</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tb2</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.clear_hoppings">
<span class="sig-name descname"><span class="pre">clear_hoppings</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.clear_hoppings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.clear_hoppings" title="Link to this definition">#</a></dt>
<dd><p>Clear all hoppings in the model.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<p class="rubric">Notes</p>
<p>This is useful for resetting the model to a state without any hoppings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.clear_onsite">
<span class="sig-name descname"><span class="pre">clear_onsite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.clear_onsite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.clear_onsite" title="Link to this definition">#</a></dt>
<dd><p>Clear all on-site energies in the model.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<p class="rubric">Notes</p>
<p>This is useful for resetting the model to a state without any on-site energies.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.get_num_orbitals">
<span class="sig-name descname"><span class="pre">get_num_orbitals</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.get_num_orbitals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.get_num_orbitals" title="Link to this definition">#</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.0.0: </span>Use ‘norb’ property instead.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.get_orb">
<span class="sig-name descname"><span class="pre">get_orb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cartesian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.get_orb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.get_orb" title="Link to this definition">#</a></dt>
<dd><p>Return orbital positions.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0: </span>Added support for Cartesian coordinates with the <cite>cartesian</cite> parameter.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cartesian</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, returns orbital positions in Cartesian coordinates.
If False, returns reduced coordinates (default).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of orbital positions, shape (norb, dim_r).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.get_lat">
<span class="sig-name descname"><span class="pre">get_lat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.get_lat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.get_lat" title="Link to this definition">#</a></dt>
<dd><p>Return lattice vectors in Cartesian coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Lattice vectors, shape (dim_r, dim_r).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.get_recip_lat">
<span class="sig-name descname"><span class="pre">get_recip_lat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.get_recip_lat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.get_recip_lat" title="Link to this definition">#</a></dt>
<dd><p>Reciprocal lattice vectors in Cartesian coordinates.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Reciprocal lattice vectors, shape (dim_k, dim_r). If not defined, returns zeros.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Only defined when dim_k == dim_r.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.get_recip_vol">
<span class="sig-name descname"><span class="pre">get_recip_vol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.get_recip_vol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.get_recip_vol" title="Link to this definition">#</a></dt>
<dd><p>Return the volume of the reciprocal lattice.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<p>The volume is defined as the absolute value of the determinant
of the reciprocal lattice vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Volume of the reciprocal lattice.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Only defined when <cite>dim_k</cite> = <cite>dim_r</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.set_k_mesh">
<span class="sig-name descname"><span class="pre">set_k_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.set_k_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.set_k_mesh" title="Link to this definition">#</a></dt>
<dd><p>Set up a uniform k-space mesh for the model.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nks</strong> (<em>array_like</em>) – Number of k-points along each periodic direction (length must be equal to dim_k).</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the number of mesh points does not match the number of periodic directions.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tb</span><span class="o">.</span><span class="n">set_k_mesh</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.get_k_mesh">
<span class="sig-name descname"><span class="pre">get_k_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.get_k_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.get_k_mesh" title="Link to this definition">#</a></dt>
<dd><p>Return the k-space mesh.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, returns the flat mesh (1D array of k-points of shape (Nk, dim_k)).
If False, returns the square mesh (multi-dimensional array of k-points).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of k-points in the mesh.
If flat, shape is (Nk, dim_k). Otherwise, shape is (nk1, nk2, …, dim_k).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NameError" title="(in Python v3.13)"><strong>NameError</strong></a> – If the k-mesh has not been initialized.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.set_onsite">
<span class="sig-name descname"><span class="pre">set_onsite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onsite_en</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_i</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'set'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.set_onsite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.set_onsite" title="Link to this definition">#</a></dt>
<dd><p>Define on-site energies for tight-binding orbitals.</p>
<p>You can set the energy for a single orbital (by specifying <cite>ind_i</cite>), or for all
orbitals at once (by passing a list/array to <cite>onsite_en</cite>).</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.0.0: </span>Using ‘reset’ for <cite>mode</cite> is deprecated, use ‘set’ instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onsite_en</strong> (float, array-like, np.ndarray of shape <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code>) – <p>If <cite>ind_i</cite> is unspecified or None, <cite>onsite_en</cite> must be a list/array of length <cite>norb</cite>.
Otherwise, it may be a single value or a 2x2 matrix in the spinful case.</p>
<dl>
<dt>For spinless models (<code class="docutils literal notranslate"><span class="pre">nspin=1</span></code>):</dt><dd><ul>
<li><p>Real scalar or list/array of real scalars (one per orbital).</p></li>
</ul>
</dd>
<dt>For spinful models (<code class="docutils literal notranslate"><span class="pre">nspin=2</span></code>):</dt><dd><ul>
<li><p>Scalar: interpreted as <span class="math notranslate nohighlight">\(a I\)</span> for both spin components.</p></li>
<li><p>4-vector <code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">b,</span> <span class="pre">c,</span> <span class="pre">d]</span></code>: interpreted as <span class="math notranslate nohighlight">\(a I + b \sigma_x + c \sigma_y + d \sigma_z\)</span>:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
    a + d &amp; b - i c \\
    b + i c &amp; a - d
\end{bmatrix}\end{split}\]</div>
</div></blockquote>
</li>
<li><p>Full 2x2 Hermitian matrix.</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>ind_i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Index of tight-binding orbital to update. If None, all orbitals are updated and
an array of the same shape as <cite>onsite_en</cite> is expected.</p></li>
<li><p><strong>mode</strong> (<em>{'set'</em><em>, </em><em>'add'}</em><em>, </em><em>optional</em>) – Specifies how <cite>onsite_en</cite> is used
- “set”: On-site energy is set to the value of <cite>onsite_en</cite>. (Default)
- “add”: Adds to the previous value of on-site energy.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If called multiple times with “add”, values are accumulated.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tb</span><span class="o">.</span><span class="n">set_onsite</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tb</span><span class="o">.</span><span class="n">set_onsite</span><span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tb</span><span class="o">.</span><span class="n">set_onsite</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;set&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tb</span><span class="o">.</span><span class="n">set_onsite</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;set&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.set_hop">
<span class="sig-name descname"><span class="pre">set_hop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hop_amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'set'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_conjugate_pair</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.set_hop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.set_hop" title="Link to this definition">#</a></dt>
<dd><p>Define hopping parameters between tight-binding orbitals.</p>
<p>In the notation of tight-binding formalism, this function specifies:</p>
<div class="math notranslate nohighlight">
\[H_{ij}(\mathbf{R}) = \langle \phi_{\mathbf{0},i} | H | \phi_{\mathbf{R},j} \rangle\]</div>
<p>where <span class="math notranslate nohighlight">\(\langle \phi_{\mathbf{0},i} |\)</span> is the i-th orbital in the home unit cell,
and <span class="math notranslate nohighlight">\(| \phi_{\mathbf{R},j} \rangle\)</span> is the j-th orbital in a cell shifted by lattice vector <span class="math notranslate nohighlight">\(\mathbf{R}\)</span>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.0.0: </span>Using ‘reset’ for <cite>mode</cite> is deprecated, use ‘set’ instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hop_amp</strong> (scalar, array-like, np.ndarray of shape <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code>) – <dl>
<dt>For spinless models (<cite>nspin=1</cite>):</dt><dd><ul>
<li><p>Real scalar or list/array of real scalars (one per orbital).</p></li>
</ul>
</dd>
<dt>For spinful models (<cite>nspin=2</cite>):</dt><dd><ul>
<li><p>Scalar: interpreted as <span class="math notranslate nohighlight">\(a I\)</span> for both spin components.</p></li>
<li><p>4-vector <code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">b,</span> <span class="pre">c,</span> <span class="pre">d]</span></code>: interpreted as <span class="math notranslate nohighlight">\(a I + b \sigma_x + c \sigma_y + d \sigma_z\)</span>:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
    a + d &amp; b - i c \\
    b + i c &amp; a - d
\end{bmatrix}\end{split}\]</div>
</div></blockquote>
</li>
<li><p>Full 2x2 Hermitian matrix.</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>ind_i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of bra orbital (in home unit cell).</p></li>
<li><p><strong>ind_j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of ket orbital (in cell shifted by <cite>ind_R</cite>).</p></li>
<li><p><strong>ind_R</strong> (<em>array-like</em><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Lattice vector in reduced coordinates pointing to the unit cell
where the ket orbital is located. Must have length <cite>dim_r</cite>. If model is non-periodic,
can be omitted.</p></li>
<li><p><strong>mode</strong> (<em>{'set'</em><em>, </em><em>'add'}</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Specifies how <cite>hop_amp</cite> is used</dt><dd><ul>
<li><p>”set”: Set the hopping term to the value of <cite>hop_amp</cite>. (Default)</p></li>
<li><p>”add”: Add <cite>hop_amp</cite> to the previous value.</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>allow_conjugate_pair</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, allows specification of both a hopping and its conjugate pair.
If False, prevents double-counting.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Strictly speaking, this term specifies hopping amplitude for hopping from site j+R to site i, not vice-versa.
There is no need to specify hoppings in both <span class="math notranslate nohighlight">\(i \rightarrow j+\mathbf{R}\)</span> and
<span class="math notranslate nohighlight">\(j \rightarrow i-\mathbf{R}\)</span> directions, since the latter is included automatically as</p>
<div class="math notranslate nohighlight">
\[H_{ji}(-\mathbf{R}) = \left[ H_{ij}(\mathbf{R}) \right]^*\]</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tb</span><span class="o">.</span><span class="n">set_hop</span><span class="p">(</span><span class="mf">0.3</span><span class="o">+</span><span class="mf">0.4</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tb</span><span class="o">.</span><span class="n">set_hop</span><span class="p">(</span><span class="mf">0.1</span><span class="o">+</span><span class="mf">0.2</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;set&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tb</span><span class="o">.</span><span class="n">set_hop</span><span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;add&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.get_velocity">
<span class="sig-name descname"><span class="pre">get_velocity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cartesian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.get_velocity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.get_velocity" title="Link to this definition">#</a></dt>
<dd><p>Generate the velocity operator</p>
<p>The velocity operator is defined via the commutator <span class="math notranslate nohighlight">\(v_k = \partial_k H_k\)</span> for an array of k-points.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_pts</strong> (<em>array</em><em> of </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>dim_k</em><em>)</em>) – Array of k-points in reduced coordinates.</p></li>
<li><p><strong>cartesian</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, use Cartesian coordinates for the velocity operator.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vel</strong> – Velocity operators at each k-point. First axis indexes the cartesian direction if <cite>cartesian</cite> is True.
Otherwise, it indexes the reduced direction.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of shape (dim_k, Nk, norb, norb)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The velocity operator is defined via the derivative of the Hamiltonian
with respect to k, i.e.,</p>
<div class="math notranslate nohighlight">
\[v_k = \frac{\partial H(k)}{\partial k}\]</div>
<p>The imaginary number is omitted.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.hamiltonian">
<span class="sig-name descname"><span class="pre">hamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_pts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.hamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.hamiltonian" title="Link to this definition">#</a></dt>
<dd><p>Generate the Bloch Hamiltonian for an array of k-points in reduced coordinates.</p>
<p>The Hamiltonian is computed in tight-binding convention I, which includes phase factors
associated with orbital positions in the hopping terms:</p>
<div class="math notranslate nohighlight">
\[H_{ij}(k) = \sum_{\mathbf{R}} t_{ij}(\mathbf{R}) \exp[i \mathbf{k} \cdot (\mathbf{r}_i - \mathbf{r}_j + \mathbf{R})]\]</div>
<p>where <span class="math notranslate nohighlight">\(t_{ij}(R)\)</span> is the hopping amplitude from orbital j to i through lattice vector <span class="math notranslate nohighlight">\(\mathbf{R}\)</span>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k_pts</strong> (<em>(</em><em>Nk</em><em>, </em><em>dim_k</em><em>) </em><em>array</em><em>, </em><em>optional</em>) – Array of k-points in reduced coordinates.
If <cite>None</cite>, the Hamiltonian is computed at a single point (<cite>dim_k = 0</cite>),
corresponding to a finite sample.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>ham</strong> – Array of Bloch-Hamiltonian matrices defined on the specified k-points. The Hamiltonian is Hermitian by construction.</p>
<ul class="simple">
<li><p>If <cite>dim_k</cite> &gt; 0: shape is (n_kpts, n_orb, n_orb) for spinless models, or (n_kpts, n_orb, 2, n_orb, 2)
for spinful models.</p></li>
<li><p>If <cite>dim_k</cite> = 0: shape is (n_orb, n_orb) for spinless or (n_orb, 2, n_orb, 2) for spinful models.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In convention I, the Hamiltonian satisfies:</p>
<div class="math notranslate nohighlight">
\[H(k) \neq H(k + G), \quad \text{but instead} \quad H(k) = U H(k + G) U^{\dagger}\]</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is a reciprocal lattice vector and <span class="math notranslate nohighlight">\(U\)</span> is a unitary transformation
relating the two.</p>
<p>Finite difference estimates of <span class="math notranslate nohighlight">\(\partial_{k_\mu} H(k)\)</span> may not be accurate at
boundaries due to the gauge discontinuity inherent in convention I.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.solve_ham">
<span class="sig-name descname"><span class="pre">solve_ham</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_eigvecs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_spin_ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.solve_ham"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.solve_ham" title="Link to this definition">#</a></dt>
<dd><p>Diagonalize the Hamiltonian</p>
<p>Solve for eigenvalues and optionally eigenvectors of the tight-binding model
at a list of one-dimensional k-vectors.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0: </span>Merged <a class="reference internal" href="#pythtb.TBModel.solve_all" title="pythtb.TBModel.solve_all"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_all()</span></code></a> and <a class="reference internal" href="#pythtb.TBModel.solve_one" title="pythtb.TBModel.solve_one"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve_one()</span></code></a> into this function.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_list</strong> (<em>array_like</em><em>, </em><em>optional</em>) – One-dimensional list or array of k-vectors, each given in reduced coordinates.
Shape should be (Nk, dim_k), where dim_k is the number of periodic directions.
Should not be specified for systems with zero-dimensional reciprocal space.</p></li>
<li><p><strong>return_eigvecs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, both eigenvalues and eigenvectors are returned.
If False (default), only eigenvalues are returned.</p></li>
<li><p><strong>keep_spin_ax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True (default), the spin axes are kept in the output eigenvectors.
If False, the spin axes are flattened.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>eval</strong> (<em>{(Nk, nstate), (nstate)} np.ndarray</em>) – Array of eigenvalues. Shape is:
- (Nk, nbnd) for periodic systems
- (nbnd,) for zero-dimensional (molecular) systems</p></li>
<li><p><strong>evec</strong> (<em>{(Nk, nstate, nstate), (nstate, nstate), (Nk, nstate, norb, 2), (nstate, norb, 2)} np.ndarray, optional</em>) – Array of eigenvectors (if <cite>return_eigvecs=True</cite>). The ordering of bands matches that in <cite>eval</cite>.</p>
<p>Eigenvectors <code class="code docutils literal notranslate"><span class="pre">evec[k,</span> <span class="pre">n,</span> <span class="pre">j]</span></code> correspond to the coefficient
<span class="math notranslate nohighlight">\(C^{n \mathbf{k}}_j\)</span> in the expansion in orbital basis.</p>
<p>For spinless models:
- Shape is (Nk, nbnd, norb)
For spinful models:
- Shape is (Nk, nbnd, norb, 2)
In zero-dimensional systems:
- (nbnd, n_orb) or (nbnd, n_orb, 2)</p>
</li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function uses the convention described in section 3.1 of the
<a class="reference download internal" download="" href="../_downloads/e39c23ce476d399b268efa520e7a9091/pythtb-formalism.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pythtb</span> <span class="pre">notes</span> <span class="pre">on</span> <span class="pre">tight-binding</span> <span class="pre">formalism</span></code></a>.
The returned wavefunctions correspond to the cell-periodic part
<span class="math notranslate nohighlight">\(u_{n \mathbf{k}}(\mathbf{r})\)</span> and not the full Bloch function
<span class="math notranslate nohighlight">\(\Psi_{n \mathbf{k}}(\mathbf{r})\)</span>.</p>
<p>In many cases, using the <a class="reference internal" href="pythtb.WFArray.html#pythtb.WFArray" title="pythtb.wf_array.WFArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">pythtb.wf_array.WFArray</span></code></a> class offers a more
elegant interface for handling eigenstates on a regular k-mesh.</p>
<p class="rubric">Examples</p>
<p>Solve for eigenvalues at several k-points:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">eval</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">solve_ham</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]])</span>
</pre></div>
</div>
<p>Solve for eigenvalues and eigenvectors:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">eval</span><span class="p">,</span> <span class="n">evec</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">solve_ham</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]],</span> <span class="n">return_eigvecs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.solve_one">
<span class="sig-name descname"><span class="pre">solve_one</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eig_vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.solve_one"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.solve_one" title="Link to this definition">#</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.0.0: </span>Use .solve_ham() instead.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.solve_all">
<span class="sig-name descname"><span class="pre">solve_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eig_vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.solve_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.solve_all" title="Link to this definition">#</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 2.0.0: </span>Use .solve_ham() instead.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.cut_piece">
<span class="sig-name descname"><span class="pre">cut_piece</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fin_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">glue_edgs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.cut_piece"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.cut_piece" title="Link to this definition">#</a></dt>
<dd><p>Cut a (d-1)-dimensional piece out of a d-dimensional tight-binding model.</p>
<p>Constructs a (d-1)-dimensional tight-binding model out of a
d-dimensional one by repeating the unit cell a given number of
times along one of the periodic lattice vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – How many times to repeat the unit cell.</p></li>
<li><p><strong>fin_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of the real space lattice vector along
which you no longer wish to maintain periodicity.</p></li>
<li><p><strong>glue_edgs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, allow hoppings from one edge to the other of a cut model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fin_model</strong> – Object of type <a class="reference internal" href="#pythtb.TBModel" title="pythtb.TBModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pythtb.TBModel</span></code></a> representing a cutout
tight-binding model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pythtb.TBModel" title="pythtb.TBModel">TBModel</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../examples_ipynb/haldane_fin.html#haldane-fin-nb"><span class="std std-ref">Finite Haldane model DOS</span></a></dt><dd><p>For an example</p>
</dd>
<dt><a class="reference internal" href="../examples_ipynb/haldane_edge.html#haldane-edge-nb"><span class="std std-ref">Haldane model edge states</span></a></dt><dd><p>For an example</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Orbitals in <cite>fin_model</cite> are numbered so that the <cite>i</cite>-th orbital of the <cite>n</cite>-th unit
cell has index <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">+</span> <span class="pre">norb</span> <span class="pre">*</span> <span class="pre">n</span></code> (here <cite>norb</cite> is the number of orbitals in the original model).</p></li>
<li><p>The real-space lattice vectors of the returned model are the same as those of
the original model; only the dimensionality of reciprocal space
is reduced.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Construct two-dimensional model B out of three-dimensional model A</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">TBModel</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>model A by repeating model along second lattice vector ten times</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">cut_piece</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Further cut two-dimensional model B into one-dimensional model
A by repeating unit cell twenty times along third lattice
vector and allow hoppings from one edge to the other</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">cut_piece</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">glue_edgs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.reduce_dim">
<span class="sig-name descname"><span class="pre">reduce_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">remove_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.reduce_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.reduce_dim" title="Link to this definition">#</a></dt>
<dd><p>Reduces dimensionality of the model by taking a reciprocal-space slice</p>
<p>This function returns a d-1 dimensional tight-binding model obtained
by constraining one of k-vector components in <span class="math notranslate nohighlight">\({\cal H}_{\bf
k}\)</span> to be a constant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>remove_k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Which reciprocal space unit vector component
you wish to keep constant.</p></li>
<li><p><strong>value_k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Value of the k-vector component to which you are
constraining this model. Must be given in reduced coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>red_tb</strong> – Reduced tight-binding model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pythtb.TBModel" title="pythtb.TBModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pythtb.TBModel</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Reduces dimensionality of the model by taking a reciprocal-space
slice of the Bloch Hamiltonian <span class="math notranslate nohighlight">\({\cal H}_{\bf k}\)</span>. The Bloch
Hamiltonian (defined in <a class="reference download internal" download="" href="../_downloads/e39c23ce476d399b268efa520e7a9091/pythtb-formalism.pdf"><code class="xref download docutils literal notranslate"><span class="pre">notes</span> <span class="pre">on</span> <span class="pre">tight-binding</span>
<span class="pre">formalism</span></code></a> in section 3.1 equation 3.7) of a
d-dimensional model is a function of d-dimensional k-vector.</p>
<p class="rubric">Examples</p>
<p>Constrains second k-vector component to equal 0.3</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">red_tb</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">reduce_dim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.change_nonperiodic_vector">
<span class="sig-name descname"><span class="pre">change_nonperiodic_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">np_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_latt_vec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_home</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_home_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.change_nonperiodic_vector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.change_nonperiodic_vector" title="Link to this definition">#</a></dt>
<dd><p>Change non-periodic lattice vector</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0.0: </span>Parameter <cite>to_home_supress_warning</cite> has been renamed to <cite>to_home_warning</cite>.
Note: this change inverts the meaning of the boolean parameter.</p>
</div>
<p>Returns tight-binding model <a class="reference internal" href="#pythtb.TBModel" title="pythtb.TBModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pythtb.TBModel</span></code></a> in which one of
the non-periodic “lattice vectors” is changed.  Non-periodic vectors are those
elements of <cite>lat</cite> that are not listed as periodic with the <cite>per</cite> parameter.</p>
<p>The returned object has modified reduced coordinates of orbitals,
consistent with the new choice of <cite>lat</cite>. Therefore, the actual
(Cartesian) coordinates of orbitals in original and returned <a class="reference internal" href="#pythtb.TBModel" title="pythtb.TBModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pythtb.TBModel</span></code></a>
are the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>np_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index of nonperiodic lattice vector to change.</p></li>
<li><p><strong>new_latt_vec</strong> (<em>array_like</em><em>, </em><em>optional</em>) – The new nonperiodic lattice vector. If None (default), the new
nonperiodic lattice vector is the same as the original one except
that all components in the periodic space have been projected out
(so that the new nonperiodic vector is perpendicular to all
periodic vectors).</p></li>
<li><p><strong>to_home</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), shift all orbitals to the home cell along
non-periodic directions.</p></li>
<li><p><strong>to_home_warning</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – <p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), code will print a warning message whenever
returned object has an orbital with at least one reduced coordinate
smaller than 0 or larger than 1 along a non-periodic direction. If
<code class="docutils literal notranslate"><span class="pre">False</span></code> the warning message will not be printed.</p>
<p>Note that this parameter has no effect on the model; it only determines whether a
warning message is printed or not.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>nnp_tb</strong> – An equivalent tight-binding model with
one redefined nonperiodic lattice vector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pythtb.TBModel" title="pythtb.TBModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pythtb.TBModel</span></code></a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pythtb.TBModel.per" title="pythtb.TBModel.per"><code class="xref py py-obj docutils literal notranslate"><span class="pre">per</span></code></a></p>
<dl class="simple">
<dt><a class="reference internal" href="../examples_ipynb/boron_nitride.html#boron-nitride-nb"><span class="std std-ref">Boron-nitride ribbon</span></a></dt><dd><p>For an example.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function is especially useful after using function cut_piece to create slabs, rods, or ribbons.</p></li>
<li><p>By default, the new non-periodic vector is constructed
from the original by removing all components in the periodic
space. This ensures that the Berry phases computed in the
periodic space correspond to the usual expectations.</p></li>
<li><p>For example, after this change, the Berry phase computed for a
ribbon depends only on the location of the Wannier center
in the extended direction, not on its location in the
transverse direction. Alternatively, the new nonperiodic
vector can be set explicitly via the <cite>new_latt_vec</cite> parameter.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Modify slab model so that nonperiodic third vector is perpendicular to the slab</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nnp_tb</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">change_nonperiodic_vector</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.make_supercell">
<span class="sig-name descname"><span class="pre">make_supercell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sc_red_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_sc_vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_home</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_home_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.make_supercell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.make_supercell" title="Link to this definition">#</a></dt>
<dd><p>Make model on a super-cell.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 2.0.0: </span>Parameter <cite>to_home_supress_warning</cite> has been renamed to <cite>to_home_warning</cite>.
Note: this change inverts the meaning of the boolean parameter.</p>
</div>
<p>Constructs a <a class="reference internal" href="#pythtb.TBModel" title="pythtb.TBModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pythtb.TBModel</span></code></a> representing a super-cell
of the current object. This function can be used together with <a class="reference internal" href="#pythtb.TBModel.cut_piece" title="pythtb.TBModel.cut_piece"><code class="xref py py-func docutils literal notranslate"><span class="pre">cut_piece()</span></code></a>
in order to create slabs with arbitrary surfaces.</p>
<p>By default all orbitals will be shifted to the home cell after
unit cell has been created. That way all orbitals will have
reduced coordinates between 0 and 1. If you wish to avoid this
behavior, you need to set, <em>to_home</em> argument to <em>False</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sc_red_lat</strong> (<em>array-like</em>) – <p>Super-cell lattice vectors in terms of reduced coordinates
of the original tight-binding model. Shape must be
<code class="docutils literal notranslate"><span class="pre">(dim_r,</span> <span class="pre">dim_r)</span></code>. First index in the array specifies super-cell vector,
while second index specifies coordinate of that super-cell vector.</p>
<p>If <cite>dim_k</cite> &lt; <cite>dim_r</cite> then still need to specify full array with
size <code class="docutils literal notranslate"><span class="pre">(dim_r,</span> <span class="pre">dim_r)</span></code> for consistency, but non-periodic
directions must have 0 on off-diagonal elements and 1 on
diagonal.</p>
</p></li>
<li><p><strong>return_sc_vectors</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Default value is <code class="docutils literal notranslate"><span class="pre">False</span></code>. If <code class="docutils literal notranslate"><span class="pre">True</span></code> returns also lattice vectors
inside the super-cell. Internally, super-cell tight-binding model will
have orbitals repeated in the same order in which these
super-cell vectors are given, but if argument <cite>to_home</cite>
is set <code class="docutils literal notranslate"><span class="pre">True</span></code> (which it is by default) then additionally,
orbitals will be shifted to the home cell.</p></li>
<li><p><strong>to_home</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Default value is <code class="docutils literal notranslate"><span class="pre">True</span></code>. If <code class="docutils literal notranslate"><span class="pre">True</span></code> will shift all orbitals
to the home cell along non-periodic directions.</p></li>
<li><p><strong>to_home_warning</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – <p>Default value is <code class="docutils literal notranslate"><span class="pre">True</span></code>. If <code class="docutils literal notranslate"><span class="pre">True</span></code> prints warning messages
about orbitals being outside the home cell (reduced coordinate larger
than 1 or smaller than 0 along non-periodic direction).</p>
<p>Note that setting this parameter to <em>True</em> or <em>False</em> has no effect on
resulting coordinates of the model.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>sc_tb</strong> (<a class="reference internal" href="#pythtb.TBModel" title="pythtb.TBModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">pythtb.TBModel</span></code></a>) – Tight-binding model in a super-cell.</p></li>
<li><p><strong>sc_vectors</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>, optional) – Super-cell vectors, returned only if
<cite>return_sc_vectors</cite> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> (default value is
<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pythtb.TBModel" title="pythtb.tb_model.TBModel"><em>TBModel</em></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The super-cell is constructed by repeating the original unit cell
according to the specified super-cell lattice vectors. The resulting
model will have a larger Brillouin zone and may exhibit different
electronic properties compared to the original model.</p>
<p class="rubric">Examples</p>
<p>Create super-cell out of 2d tight-binding model <code class="docutils literal notranslate"><span class="pre">tb</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sc_tb</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">make_supercell</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.add_orb">
<span class="sig-name descname"><span class="pre">add_orb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.add_orb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.add_orb" title="Link to this definition">#</a></dt>
<dd><p>Adds a new orbital to the model with the specified coordinates.</p>
<p>The orbital coordinate must be given in reduced
coordinates, i.e. in units of the real-space lattice vectors
of the model. The new orbital is added at the end of the list
of orbitals, and the orbital index is set to the next available
index.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coord</strong> (<em>array_like</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The reduced coordinates of the new orbital of length <cite>dim_r</cite>. If
<cite>coord</cite> is a single float or int, it will be converted to a 1D array
(<cite>dim_r</cite> must be 1).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.remove_orb">
<span class="sig-name descname"><span class="pre">remove_orb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">to_remove</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.remove_orb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.remove_orb" title="Link to this definition">#</a></dt>
<dd><p>Removes specified orbitals from the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>to_remove</strong> (<em>array-like</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – List of orbital indices to be removed, or index of single orbital to be removed</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>del_tb</strong> – Model with removed orbitals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class:<cite>pythtb.TBModel</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Removing orbitals will reindex the orbitals with indices higher
than those that are removed. For example, if model has 6 orbitals
and you remove the 2nd orbital, then the orbitals 3-6 will be
reindexed to 1-4 (Python counting). Indices of first two orbitals (0 and 1)
are unaffected.</p>
<p class="rubric">Examples</p>
<p>If original_model has say 10 orbitals then returned small_model will
have only 8 orbitals.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">small_model</span> <span class="o">=</span> <span class="n">original_model</span><span class="o">.</span><span class="n">remove_orb</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.k_uniform_mesh">
<span class="sig-name descname"><span class="pre">k_uniform_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.k_uniform_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.k_uniform_mesh" title="Link to this definition">#</a></dt>
<dd><p>Uniform grid of k-points in reduced coordinates.</p>
<p>The mesh along each direction is defined from [0, 1).
The mesh always contains the origin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mesh_size</strong> (<em>array_like</em>) – Number of k-points in the mesh in each periodic direction of the model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>k_vec</strong> – Array of k-vectors on the mesh that can be directly passed to function
<a class="reference internal" href="#pythtb.TBModel.solve_all" title="pythtb.TBModel.solve_all"><code class="xref py py-func docutils literal notranslate"><span class="pre">pythtb.TBModel.solve_all()</span></code></a>. The shape of the array is
(nk1, nk2, …, dim_k) where nk1, nk2, … are the number of k-points
in each direction defined by <cite>mesh_size</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The uniform grid of k-points that can be passed to
function <a class="reference internal" href="#pythtb.TBModel.solve_all" title="pythtb.TBModel.solve_all"><code class="xref py py-func docutils literal notranslate"><span class="pre">pythtb.TBModel.solve_all()</span></code></a>.</p>
<p class="rubric">Examples</p>
<p>Returns a 10x20x30 mesh of a tight binding model
with three periodic directions</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k_vec</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">k_uniform_mesh</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">k_vec</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(10, 20, 30, 3)</span>
</pre></div>
</div>
<p>Solve model on the uniform mesh</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_model</span><span class="o">.</span><span class="n">solve_ham</span><span class="p">(</span><span class="n">k_vec</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.k_path">
<span class="sig-name descname"><span class="pre">k_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kpts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.k_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.k_path" title="Link to this definition">#</a></dt>
<dd><p>Interpolates a path in reciprocal space.</p>
<p>Interpolates a path in reciprocal space between specified
k-points. In 2D or 3D the k-path can consist of several
straight segments connecting high-symmetry points (“nodes”),
and the results can be used to plot the bands along this path.</p>
<p>The interpolated path that is returned contains as
equidistant k-points as possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kpts</strong> (<em>array-like</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>Array of k-vectors in reciprocal space between
which interpolated path should be constructed. These
k-vectors must be given in reduced coordinates.  As a
special case, in 1D k-space kpts may be a string:</p>
<ul>
<li><p><cite>”full”</cite>: Implies  <code class="docutils literal notranslate"><span class="pre">[0.0,</span> <span class="pre">0.5,</span> <span class="pre">1.0]</span></code> (full BZ)</p></li>
<li><p><cite>”fullc”</cite>: Implies  <code class="docutils literal notranslate"><span class="pre">[-0.5,</span> <span class="pre">0.0,</span> <span class="pre">0.5]</span></code> (full BZ, centered)</p></li>
<li><p><cite>”half”</cite>: Implies  <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">0.0,</span> <span class="pre">0.5]</span></code>  (half BZ)</p></li>
</ul>
</p></li>
<li><p><strong>nk</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Total number of k-points to be used in making the plot.</p></li>
<li><p><strong>report</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Optional parameter specifying whether printout
is desired (default is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>k_vec</strong> (<em>np.ndarray</em>) – Array of (nearly) equidistant interpolated k-points.</p></li>
<li><p><strong>k_dist</strong> (<em>np.ndarray</em>) – Array giving accumulated k-distance to each
k-point in the path. This array can be used to plot path in
the k-space so that the distances between the k-points in
the plot are exact.</p></li>
<li><p><strong>k_node</strong> (<em>np.ndarray</em>) – Array giving accumulated k-distance to each
node on the path in Cartesian coordinates. This array is
typically used to plot nodes (typically special points) on
the path in k-space.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The distance between the points is calculated in the Cartesian frame,
however coordinates themselves are given in dimensionless reduced coordinates!
This is done so that this array can be directly passed to function
<a class="reference internal" href="#pythtb.TBModel.solve_ham" title="pythtb.TBModel.solve_ham"><code class="xref py py-func docutils literal notranslate"><span class="pre">pythtb.TBModel.solve_ham()</span></code></a>.</p></li>
<li><p>Unlike array <cite>k_vec</cite>, <cite>k_dist</cite> has dimensions! Units are defined here
so that for a one-dimensional crystal with lattice constant equal to
for example <cite>10</cite> the length of the Brillouin zone would equal
<cite>1/10=0.1</cite>. In other words factors of <span class="math notranslate nohighlight">\(2\pi\)</span> are
absorbed into <cite>kpts</cite>.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Construct a path connecting four nodal points in k-space
Path will contain 401 k-points, roughly equally spaced</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">path</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">k_vec</span><span class="p">,</span> <span class="n">k_dist</span><span class="p">,</span> <span class="n">k_node</span><span class="p">)</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">k_path</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="mi">401</span><span class="p">)</span>
</pre></div>
</div>
<p>Solve for eigenvalues on that path</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evals</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">solve_all</span><span class="p">(</span><span class="n">k_vec</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.ignore_position_operator_offdiagonal">
<span class="sig-name descname"><span class="pre">ignore_position_operator_offdiagonal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.ignore_position_operator_offdiagonal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.ignore_position_operator_offdiagonal" title="Link to this definition">#</a></dt>
<dd><p>Set flag to ignore off-diagonal elements of the position operator.</p>
<p>Call to this function enables one to approximately compute
Berry-like objects from tight-binding models that were
obtained from Wannier90.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.position_matrix">
<span class="sig-name descname"><span class="pre">position_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.position_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.position_matrix" title="Link to this definition">#</a></dt>
<dd><p>Position operator matrix elements</p>
<p>Returns matrix elements of the position operator along
direction <cite>dir</cite> for eigenvectors <cite>evec</cite> at a single k-point.
Position operator is defined in reduced coordinates.</p>
<p>The returned object <span class="math notranslate nohighlight">\(X\)</span> is</p>
<div class="math notranslate nohighlight">
\[X_{m n {\bf k}}^{\alpha} = \langle u_{m {\bf k}} \vert
r^{\alpha} \vert u_{n {\bf k}} \rangle\]</div>
<p>Here <span class="math notranslate nohighlight">\(r^{\alpha}\)</span> is the position operator along direction
<span class="math notranslate nohighlight">\(\alpha\)</span> that is selected by <cite>dir</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evec</strong> (<em>np.ndarray</em>) – Eigenvectors for which we are computing matrix
elements of the position operator.  The shape of this array
is <code class="docutils literal notranslate"><span class="pre">evec[band,</span> <span class="pre">orbital]</span></code> if <cite>nspin</cite> = 1 and
<code class="docutils literal notranslate"><span class="pre">evec[band,</span> <span class="pre">orbital,</span> <span class="pre">spin]</span></code> if <cite>nspin</cite> = 2.</p></li>
<li><p><strong>dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Direction along which we are computing the center.
This integer must not be one of the periodic directions
since position operator matrix element in that case is not
well defined.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pos_mat</strong> – Position operator matrix <span class="math notranslate nohighlight">\(X_{m n}\)</span> as defined above.
This is a square matrix with size determined by number of bands
given in <cite>evec</cite> input array.  First index of <cite>pos_mat</cite> corresponds to
bra vector (<span class="math notranslate nohighlight">\(m\)</span>) and second index to ket (<span class="math notranslate nohighlight">\(n\)</span>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../examples_ipynb/haldane_hwf.html#haldane-hwf-nb"><span class="std std-ref">Haldane model hybrid Wannier functions</span></a></dt><dd><p>For an example.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Diagonalizes Hamiltonian at some k-points</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">solve_ham</span><span class="p">(</span><span class="n">k_vec</span><span class="p">,</span> <span class="n">return_eigvecs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Computes position operator matrix elements for 3-rd kpoint
and bottom five bands along first coordinate</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos_mat</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">position_matrix</span><span class="p">(</span><span class="n">evecs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.position_expectation">
<span class="sig-name descname"><span class="pre">position_expectation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.position_expectation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.position_expectation" title="Link to this definition">#</a></dt>
<dd><p>Returns diagonal matrix elements of the position operator.</p>
<p>These elements <span class="math notranslate nohighlight">\(X_{n n}\)</span> can be interpreted as an
average position of n-th Bloch state <code class="docutils literal notranslate"><span class="pre">evec[n]</span></code> along
direction <cite>dir</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evec</strong> (<em>np.ndarray</em>) – Eigenvectors for which we are computing matrix
elements of the position operator. The shape of this array
is <code class="docutils literal notranslate"><span class="pre">evec[band,</span> <span class="pre">orbital]</span></code> if <code class="docutils literal notranslate"><span class="pre">nspin=1</span></code> and
<code class="docutils literal notranslate"><span class="pre">evec[band,</span> <span class="pre">orbital,</span> <span class="pre">spin]</span></code> if <code class="docutils literal notranslate"><span class="pre">nspin=2</span></code>.</p></li>
<li><p><strong>dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Direction along which we are computing matrix
elements. This integer must not be one of the periodic
directions since position operator matrix element in that
case is not well defined.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pos_exp</strong> – Diagonal elements of the position operator matrix <span class="math notranslate nohighlight">\(X\)</span>.
Length of this vector is determined by number of bands given in <em>evec</em> input
array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../examples_ipynb/haldane_hwf.html#haldane-hwf-nb"><span class="std std-ref">Haldane model hybrid Wannier functions</span></a></dt><dd><p>For an example.</p>
</dd>
<dt><a class="reference internal" href="#pythtb.TBModel.position_matrix" title="pythtb.TBModel.position_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">position_matrix</span></code></a></dt><dd><p>For definition of matrix <span class="math notranslate nohighlight">\(X\)</span>.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Generally speaking these centers are _not_
hybrid Wannier function centers (which are instead
returned by <a class="reference internal" href="#pythtb.TBModel.position_hwf" title="pythtb.TBModel.position_hwf"><code class="xref py py-func docutils literal notranslate"><span class="pre">TBModel.position_hwf()</span></code></a>).</p>
<p class="rubric">Examples</p>
<p>Diagonalizes Hamiltonian at some k-points</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">solve_ham</span><span class="p">(</span><span class="n">k_vec</span><span class="p">,</span> <span class="n">return_eigvecs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Computes average position for 3-rd kpoint
and bottom five bands along first coordinate</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos_exp</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">position_expectation</span><span class="p">(</span><span class="n">evecs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.position_hwf">
<span class="sig-name descname"><span class="pre">position_hwf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hwf_evec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'orbital'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.position_hwf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.position_hwf" title="Link to this definition">#</a></dt>
<dd><p>Eigenvalues and eigenvectors of the position operator</p>
<p>Returns eigenvalues and optionally eigenvectors of the
position operator matrix <span class="math notranslate nohighlight">\(X\)</span> in basis of the orbitals
or, optionally, of the input wave functions (typically Bloch
functions). The returned eigenvectors can be interpreted as
linear combinations of the input states <code class="docutils literal notranslate"><span class="pre">evec</span></code> that have
minimal extent (or spread <span class="math notranslate nohighlight">\(\Omega\)</span> in the sense of
maximally localized Wannier functions) along direction
<code class="docutils literal notranslate"><span class="pre">dir</span></code>. The eigenvalues are average positions of these
localized states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evec</strong> (<em>np.ndarray</em>) – Eigenvectors for which we are computing matrix
elements of the position operator. The shape of this array
is <code class="docutils literal notranslate"><span class="pre">evec[band,</span> <span class="pre">orbital]</span></code> if <code class="docutils literal notranslate"><span class="pre">nspin=1</span></code> and
<code class="docutils literal notranslate"><span class="pre">evec[band,</span> <span class="pre">orbital,</span> <span class="pre">spin]</span></code> if <code class="docutils literal notranslate"><span class="pre">nspin=2</span></code>.</p></li>
<li><p><strong>dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Direction along which we are computing matrix
elements. This integer must not be one of the periodic
directions since position operator matrix element in that
case is not well defined.</p></li>
<li><p><strong>hwf_evec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code> this function will
return not only eigenvalues but also eigenvectors of <span class="math notranslate nohighlight">\(X\)</span>.</p></li>
<li><p><strong>basis</strong> (<em>{&quot;orbital&quot;</em><em>, </em><em>&quot;wavefunction&quot;</em><em>, </em><em>&quot;bloch&quot;}</em><em>, </em><em>optional</em>) – Default is “orbital”. If <code class="docutils literal notranslate"><span class="pre">basis=&quot;wavefunction&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">basis=&quot;bloch&quot;</span></code>, the hybrid
Wannier function <cite>hwf</cite> is returned in the basis of the input
wave functions. That is, the elements of <code class="docutils literal notranslate"><span class="pre">hwf[i,</span> <span class="pre">j]</span></code> give the amplitudes
of the i-th hybrid Wannier function on the j-th input state.
If <code class="docutils literal notranslate"><span class="pre">basis=&quot;orbital&quot;</span></code>, the elements of <code class="docutils literal notranslate"><span class="pre">hwf[i,</span> <span class="pre">orb]</span></code> (or <code class="docutils literal notranslate"><span class="pre">hwf[i,</span> <span class="pre">orb,</span> <span class="pre">spin]</span></code>
if <code class="docutils literal notranslate"><span class="pre">nspin=2</span></code>) give the amplitudes of the i-th hybrid Wannier function on
the specified basis function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><strong>hwfc</strong> (<em>np.ndarray</em>) – Eigenvalues of the position operator matrix <span class="math notranslate nohighlight">\(X\)</span>
(also called hybrid Wannier function centers).
Length of this vector equals number of bands given in <code class="docutils literal notranslate"><span class="pre">evec</span></code>
input array. Hybrid Wannier function centers are ordered in ascending order.
Note that in general <cite>n</cite>-th hwfc does not correspond to <cite>n</cite>-th
state in <code class="docutils literal notranslate"><span class="pre">evec</span></code>.</p></li>
<li><p><strong>hwf</strong> (<em>np.ndarray</em>) – Eigenvectors of the position operator matrix <span class="math notranslate nohighlight">\(X\)</span>.
(also called hybrid Wannier functions).  These are returned only if
parameter <code class="docutils literal notranslate"><span class="pre">hwf_evec</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<p>The shape of this array is <code class="docutils literal notranslate"><span class="pre">[h,x]</span></code> or <code class="docutils literal notranslate"><span class="pre">[h,x,s]</span></code> depending on value of
<code class="docutils literal notranslate"><span class="pre">basis</span></code> and <code class="docutils literal notranslate"><span class="pre">nspin</span></code>.</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">basis</span></code> is “bloch” then <code class="docutils literal notranslate"><span class="pre">x</span></code> refers to indices of
Bloch states.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">basis</span></code> is “orbital” then <code class="docutils literal notranslate"><span class="pre">x</span></code> (or <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code>)
correspond to orbital index (or orbital and spin index if <code class="docutils literal notranslate"><span class="pre">nspin=2</span></code>).</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../examples_ipynb/haldane_hwf.html#haldane-hwf-nb"><span class="std std-ref">Haldane model hybrid Wannier functions</span></a></dt><dd><p>For an example.</p>
</dd>
<dt><a class="reference internal" href="#pythtb.TBModel.position_matrix" title="pythtb.TBModel.position_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">position_matrix</span></code></a></dt><dd><p>For the definition of the matrix <span class="math notranslate nohighlight">\(X\)</span>.</p>
</dd>
<dt><a class="reference internal" href="#pythtb.TBModel.position_expectation" title="pythtb.TBModel.position_expectation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">position_expectation</span></code></a></dt><dd><p>For the position expectation value.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Note that these eigenvectors are not maximally localized
Wannier functions in the usual sense because they are
localized only along one direction. They are also not the
average positions of the Bloch states <cite>evec</cite>, which are
instead computed by <a class="reference internal" href="#pythtb.TBModel.position_expectation" title="pythtb.TBModel.position_expectation"><code class="xref py py-func docutils literal notranslate"><span class="pre">position_expectation()</span></code></a>.</p>
<p>See Fig. 3 in <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> for a discussion of the hybrid Wannier function centers in the
context of a Chern insulator.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<ol class="upperalpha simple" start="19">
<li><p>Coh, D. Vanderbilt, Phys. Rev. Lett. 102, 107603 (2009).</p></li>
</ol>
</aside>
</aside>
<p class="rubric">Examples</p>
<p>Diagonalizes Hamiltonian at some k-points</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">solve_ham</span><span class="p">(</span><span class="n">k_vec</span><span class="p">,</span> <span class="n">return_eigvecs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Computes hybrid Wannier centers (and functions) for 3-rd kpoint
and bottom five bands along first coordinate</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hwfc</span><span class="p">,</span> <span class="n">hwf</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">position_hwf</span><span class="p">(</span><span class="n">evecs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hwf_evec</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;orbital&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.berry_curvature">
<span class="sig-name descname"><span class="pre">berry_curvature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_pts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evecs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occ_idxs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cartesian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abelian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.berry_curvature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.berry_curvature" title="Link to this definition">#</a></dt>
<dd><p>Compute the Berry curvature at a list of k-points.</p>
<p>The Berry curvature is computed from the velocity operator
<span class="math notranslate nohighlight">\(v_k = i \partial_k H_k\)</span>. Specifically, for <span class="math notranslate nohighlight">\((m,n) \in \text{occ}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\Omega_{\mu \nu;\ mn}(k) =  \sum_{l \notin \text{occ}}
\frac{
    \langle u_{mk} | v^{\mu}_k | u_{lk} \rangle
    \langle u_{lk} | v_k^{\nu} | u_{nk} \rangle
    -
    \langle u_{mk} | v_k^{\nu} | u_{lk} \rangle
    \langle u_{lk} | v_k^{\mu} | u_{nk} \rangle
}{
    (E_{nk} - E_{lk})(E_{mk} - E_{lk})
}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_pts</strong> (<em>(</em><em>Nk</em><em>, </em><em>dim_k</em><em>) </em><em>array-like</em>) – Array of k-points with shape (Nk, dim_k), where Nk is the number of points
and dim_k is the dimensionality of the k-space.</p></li>
<li><p><strong>evals</strong> (<em>(</em><em>Nk</em><em>, </em><em>n_states</em><em>) </em><em>array</em><em>, </em><em>optional</em>) – Eigenvalues of the Hamiltonian at the k-points. If not provided, they will be computed.</p></li>
<li><p><strong>evecs</strong> (<em>(</em><em>Nk</em><em>, </em><em>n_states</em><em>, </em><em>n_orb</em><em>) </em><em>array</em><em>, </em><em>optional</em>) – Eigenvectors of the Hamiltonian. If not provided, they will be computed.</p></li>
<li><p><strong>occ_idxs</strong> (<em>1D array</em><em>, </em><em>optional</em>) – Indices of the occupied bands. Defaults to the first half of the states.</p></li>
<li><p><strong>dirs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Directions in k-space for which to compute the curvature.
If “all”, computes all components. If a tuple, restricts to specified indices.</p></li>
<li><p><strong>cartesian</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, computes the velocity operator in Cartesian coordinates.
Default is False (reduced coordinates).</p></li>
<li><p><strong>abelian</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, returns the trace of the Berry curvature tensor (abelian case).
If False, returns the full tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>b_curv</strong> – Berry curvature tensor. If <code class="docutils literal notranslate"><span class="pre">dirs</span></code> is “all”, shape is (dim_k, dim_k, Nk, n_orb, n_orb).
If <code class="docutils literal notranslate"><span class="pre">dirs</span></code> is a tuple, shape is (Nk, n_orb, n_orb) and the returned tensor is restricted
to the specified directions.
If <code class="docutils literal notranslate"><span class="pre">abelian</span></code> is True, returns the band-trace of the Berry curvature tensor and the last
two dimensions are not present.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This quantity is an anti-symmetric under <span class="math notranslate nohighlight">\(\mu \leftrightarrow \nu\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.chern">
<span class="sig-name descname"><span class="pre">chern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occ_idxs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.chern"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.chern" title="Link to this definition">#</a></dt>
<dd><p>Computes Chern number for occupied manifold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occ_idxs</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Occupied band indices. If none are provided,
the lower half bands are considered occupied.</p></li>
<li><p><strong>dirs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – Indices for reciprocal space directions defining
2d surface to integrate Berry flux.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Chern number for the occupied manifold.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.visualize">
<span class="sig-name descname"><span class="pre">visualize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proj_plane</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eig_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_hoppings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate_onsite_en</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.visualize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.visualize" title="Link to this definition">#</a></dt>
<dd><p>Visualizes the tight-binding model geometry.</p>
<p>Plots the tight-binding orbitals, hopping between tight-binding orbitals,
and optionally the electron eigenstates.</p>
<p>If eigenvector is not drawn, then orbitals in home cell are drawn
as red circles, and those in neighboring cells are drawn with
a lighter shade of red. Hopping term directions are drawn with
green lines connecting two orbitals. Origin of unit cell is
indicated with blue dot, while real space unit vectors are drawn
with blue lines.</p>
<p>If eigenvector is drawn, then electron eigenstate on each orbital
is drawn with a circle whose size is proportional to wavefunction
amplitude while its color depends on the phase. There are various
coloring schemes for the phase factor; see more details under
<cite>ph_color</cite> parameter. If eigenvector is drawn and coloring scheme
is “red-blue” or “wheel”, all other elements of the picture are
drawn in gray or black.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proj_plane</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><em>two integers</em>) – Cartesian coordinates to be used for plotting. For example,
if <code class="docutils literal notranslate"><span class="pre">proj_plane=(0,1)</span></code> then x-y projection of the model is
drawn. This only should be specified if <cite>dim_r</cite> &gt; 2.</p></li>
<li><p><strong>eig_dr</strong> (<em>Optional parameter specifying eigenstate to</em>) – plot. If specified, this should be one-dimensional array of
complex numbers specifying wavefunction at each orbital in
the tight-binding basis. If not specified, eigenstate is not
drawn.</p></li>
<li><p><strong>draw_hoppings</strong> (<em>Optional parameter specifying whether to</em>) – draw all allowed hopping terms in the tight-binding
model. Default value is True.</p></li>
<li><p><strong>ph_color</strong> (<em>{&quot;black&quot;</em><em>, </em><em>&quot;red-blue&quot;</em><em>, </em><em>&quot;wheel&quot;}</em><em>, </em><em>optional</em>) – <p>Determines the way the eigenvector phase factors are
translated into color. Default value is “black”.</p>
<ul>
<li><p>”black” – phase of eigenvectors are ignored and wavefunction
is always colored in black.</p></li>
<li><p>”red-blue” – zero phase is drawn red, while phases or <span class="math notranslate nohighlight">\(\pi\)</span> or
<span class="math notranslate nohighlight">\(-\pi\)</span> are drawn blue. Phases in between are interpolated between
red and blue. Some phase information is lost in this coloring
because phase of <span class="math notranslate nohighlight">\(\pm \pi\)</span> have the same color.</p></li>
<li><p>”wheel” – each phase is given unique color. In steps of <span class="math notranslate nohighlight">\(\pi/3\)</span>
starting from 0, colors are assigned (in increasing hue) as:
red, yellow, green, cyan, blue, magenta, red.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em>) – Figure object from matplotlib.pyplot module</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – Axes object from matplotlib.pyplot module</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>This function is intended for visualizing tight-binding models
in two dimensions. For three-dimensional visualizations, consider using
the <a class="reference internal" href="#pythtb.TBModel.visualize_3d" title="pythtb.TBModel.visualize_3d"><code class="xref py py-func docutils literal notranslate"><span class="pre">visualize_3d()</span></code></a> method.</p></li>
<li><p>Convention of the wavefunction phase is as
in convention 1 in section 3.1 of <a class="reference download internal" download="" href="../_downloads/e39c23ce476d399b268efa520e7a9091/pythtb-formalism.pdf"><code class="xref download docutils literal notranslate"><span class="pre">notes</span> <span class="pre">on</span>
<span class="pre">tight-binding</span> <span class="pre">formalism</span></code></a>. In
other words, these wavefunction phases are in correspondence
with cell-periodic functions <span class="math notranslate nohighlight">\(u_{n {\bf k}} ({\bf r})\)</span>
not <span class="math notranslate nohighlight">\(\Psi_{n {\bf k}} ({\bf r})\)</span>.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Draws x-y projection of tight-binding model
tweaks figure and saves it as a PDF.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">tb</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code></dt><dd><p>ref:<cite>haldane-edge-nb</cite>,</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">-</span></code></dt><dd><p>ref:<cite>visualize-nb</cite>.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.visualize_3d">
<span class="sig-name descname"><span class="pre">visualize_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eig_dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_hoppings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_model_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ph_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.visualize_3d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.visualize_3d" title="Link to this definition">#</a></dt>
<dd><p>Visualize a 3D tight-binding model using <code class="docutils literal notranslate"><span class="pre">Plotly</span></code>.</p>
<p>This function creates an interactive 3D plot of your tight-binding model,
showing the unit-cell origin, lattice vectors (with arrowheads), orbitals,
hopping lines, and (optionally) an eigenstate overlay with marker sizes
proportional to amplitude and colors reflecting the phase.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eig_dr</strong> – Optional eigenstate (1D array of complex numbers) to display.</p></li>
<li><p><strong>draw_hoppings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to draw hopping lines between orbitals.</p></li>
<li><p><strong>annotate_onsite_en</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to annotate orbitals with onsite energies.</p></li>
<li><p><strong>ph_color</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Coloring scheme for eigenstate phases (e.g. “black”, “red-blue”, “wheel”).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>plotly.graph_objs.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.TBModel.plot_bands">
<span class="sig-name descname"><span class="pre">plot_bands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">101</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_orb_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scat_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'solid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'plasma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/tb_model.html#TBModel.plot_bands"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.TBModel.plot_bands" title="Link to this definition">#</a></dt>
<dd><p>Plot the band structure along a specified path in k-space.</p>
<p>This function allows for customization of the plot, including projection of orbitals,
spin projection, figure and axis objects, title, scatter size, line width,
line color, line style, colormap, and whether to show a color bar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>) – List of high symmetry points to plot bands through</p></li>
<li><p><strong>nk</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Number of k-points to sample along the path. Defaults to 101.</p></li>
<li><p><strong>k_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – Labels of high symmetry points. Defaults to None.</p></li>
<li><p><strong>proj_orb_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – List of orbital indices to project onto. Defaults to None.
This will give the bands a colorscale indicating the weight of
the Bloch states onto the list of orbitals.</p></li>
<li><p><strong>proj_spin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to project the spin components. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.
If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the bands will be colored according to their spin character.</p></li>
<li><p><strong>fig</strong> (<em>matplotlib.figure.Figure</em><em>, </em><em>optional</em>) – Figure object to plot on. Defaults to None.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em>, </em><em>optional</em>) – Axes object to plot on. Defaults to None.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Title of the plot. Defaults to None.</p></li>
<li><p><strong>scat_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Size of the scatter points. Defaults to 3.</p></li>
<li><p><strong>lw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Line width of the band lines. Defaults to 2.</p></li>
<li><p><strong>lc</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Line color of the band lines. Defaults to “b”. Irrelevant
if <cite>proj_spin</cite> is True or <cite>proj_orb_idx</cite> is not None.</p></li>
<li><p><strong>ls</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Line style of the band lines. Defaults to “solid”.
Irrelevant if <cite>proj_spin</cite> is True or <cite>proj_orb_idx</cite> is not None.</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Colormap for the band plot. Defaults to “plasma”. Only relevant if
<cite>proj_spin</cite> is True or <cite>proj_orb_idx</cite> is not None.</p></li>
<li><p><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to show the plot. Defaults to False.</p></li>
<li><p><strong>cbar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to show a color bar. Defaults to True.
Only relevant if <cite>proj_spin</cite> is True or <cite>proj_orb_idx</cite> is not None.</p></li>
<li><p><strong>Returns</strong> – fig : matplotlib.figure.Figure
ax: matplotlib.axes.Axes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "youruser/yourrepo",
            ref: "v2",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./generated"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../usage.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Usage</p>
      </div>
    </a>
    <a class="right-next"
       href="pythtb.WFArray.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">pythtb.WFArray</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel"><code class="docutils literal notranslate"><span class="pre">TBModel</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.__init__"><code class="docutils literal notranslate"><span class="pre">TBModel.__init__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.display"><code class="docutils literal notranslate"><span class="pre">TBModel.display()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.report"><code class="docutils literal notranslate"><span class="pre">TBModel.report()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.dim_r"><code class="docutils literal notranslate"><span class="pre">TBModel.dim_r</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.dim_k"><code class="docutils literal notranslate"><span class="pre">TBModel.dim_k</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.nspin"><code class="docutils literal notranslate"><span class="pre">TBModel.nspin</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.per"><code class="docutils literal notranslate"><span class="pre">TBModel.per</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.norb"><code class="docutils literal notranslate"><span class="pre">TBModel.norb</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.nstate"><code class="docutils literal notranslate"><span class="pre">TBModel.nstate</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.lat_vecs"><code class="docutils literal notranslate"><span class="pre">TBModel.lat_vecs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.orb_vecs"><code class="docutils literal notranslate"><span class="pre">TBModel.orb_vecs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.site_energies"><code class="docutils literal notranslate"><span class="pre">TBModel.site_energies</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.hoppings"><code class="docutils literal notranslate"><span class="pre">TBModel.hoppings</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.assume_position_operator_diagonal"><code class="docutils literal notranslate"><span class="pre">TBModel.assume_position_operator_diagonal</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.copy"><code class="docutils literal notranslate"><span class="pre">TBModel.copy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.clear_hoppings"><code class="docutils literal notranslate"><span class="pre">TBModel.clear_hoppings()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.clear_onsite"><code class="docutils literal notranslate"><span class="pre">TBModel.clear_onsite()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.get_num_orbitals"><code class="docutils literal notranslate"><span class="pre">TBModel.get_num_orbitals()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.get_orb"><code class="docutils literal notranslate"><span class="pre">TBModel.get_orb()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.get_lat"><code class="docutils literal notranslate"><span class="pre">TBModel.get_lat()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.get_recip_lat"><code class="docutils literal notranslate"><span class="pre">TBModel.get_recip_lat()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.get_recip_vol"><code class="docutils literal notranslate"><span class="pre">TBModel.get_recip_vol()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.set_k_mesh"><code class="docutils literal notranslate"><span class="pre">TBModel.set_k_mesh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.get_k_mesh"><code class="docutils literal notranslate"><span class="pre">TBModel.get_k_mesh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.set_onsite"><code class="docutils literal notranslate"><span class="pre">TBModel.set_onsite()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.set_hop"><code class="docutils literal notranslate"><span class="pre">TBModel.set_hop()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.get_velocity"><code class="docutils literal notranslate"><span class="pre">TBModel.get_velocity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.hamiltonian"><code class="docutils literal notranslate"><span class="pre">TBModel.hamiltonian()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.solve_ham"><code class="docutils literal notranslate"><span class="pre">TBModel.solve_ham()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.solve_one"><code class="docutils literal notranslate"><span class="pre">TBModel.solve_one()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.solve_all"><code class="docutils literal notranslate"><span class="pre">TBModel.solve_all()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.cut_piece"><code class="docutils literal notranslate"><span class="pre">TBModel.cut_piece()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.reduce_dim"><code class="docutils literal notranslate"><span class="pre">TBModel.reduce_dim()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.change_nonperiodic_vector"><code class="docutils literal notranslate"><span class="pre">TBModel.change_nonperiodic_vector()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.make_supercell"><code class="docutils literal notranslate"><span class="pre">TBModel.make_supercell()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.add_orb"><code class="docutils literal notranslate"><span class="pre">TBModel.add_orb()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.remove_orb"><code class="docutils literal notranslate"><span class="pre">TBModel.remove_orb()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.k_uniform_mesh"><code class="docutils literal notranslate"><span class="pre">TBModel.k_uniform_mesh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.k_path"><code class="docutils literal notranslate"><span class="pre">TBModel.k_path()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.ignore_position_operator_offdiagonal"><code class="docutils literal notranslate"><span class="pre">TBModel.ignore_position_operator_offdiagonal()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.position_matrix"><code class="docutils literal notranslate"><span class="pre">TBModel.position_matrix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.position_expectation"><code class="docutils literal notranslate"><span class="pre">TBModel.position_expectation()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.position_hwf"><code class="docutils literal notranslate"><span class="pre">TBModel.position_hwf()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.berry_curvature"><code class="docutils literal notranslate"><span class="pre">TBModel.berry_curvature()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.chern"><code class="docutils literal notranslate"><span class="pre">TBModel.chern()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.visualize"><code class="docutils literal notranslate"><span class="pre">TBModel.visualize()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.visualize_3d"><code class="docutils literal notranslate"><span class="pre">TBModel.visualize_3d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.TBModel.plot_bands"><code class="docutils literal notranslate"><span class="pre">TBModel.plot_bands()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Trey Cole, Sinisa Coh, and David Vanderbilt.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>