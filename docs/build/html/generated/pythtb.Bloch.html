
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pythtb.Bloch &#8212; PythTB Docs</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=1a152b8d" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=7f41d439"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=cbcfbdad"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'generated/pythtb.Bloch';</script>
    <script defer="defer" src="../_static/custom-icons.js?v=7518156e"></script>
    <script src="https://unpkg.com/thebe@latest/lib/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pythtb.plotting.plot_bands" href="pythtb.plotting.plot_bands.html" />
    <link rel="prev" title="pythtb.Wannier" href="pythtb.Wannier.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">PythTB Docs</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Install
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../CHANGELOG.html">
    Changelog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../formalism.html">
    Formalism
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../resources.html">
    Resources
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../citation.html">
    Citation
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/treycole/pythtb" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/pythtb/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Install
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../usage.html">
    Usage
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../CHANGELOG.html">
    Changelog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../formalism.html">
    Formalism
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../resources.html">
    Resources
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../citation.html">
    Citation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/treycole/pythtb" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/pythtb/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">PythTB Classes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pythtb.TBModel.html">pythtb.TBModel</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.WFArray.html">pythtb.WFArray</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.W90.html">pythtb.W90</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.Wannier.html">pythtb.Wannier</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">pythtb.Bloch</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PythTB Plotting</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pythtb.plotting.plot_bands.html">pythtb.plotting.plot_bands</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.plotting.plot_tb_model.html">pythtb.plotting.plot_tb_model</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.plotting.plot_tb_model_3d.html">pythtb.plotting.plot_tb_model_3d</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PythTB Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.ssh.html">pythtb.models.ssh</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.checkerboard.html">pythtb.models.checkerboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.graphene.html">pythtb.models.graphene</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.haldane.html">pythtb.models.haldane</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.kane_mele.html">pythtb.models.kane_mele</a></li>
<li class="toctree-l1"><a class="reference internal" href="pythtb.models.fu_kane_mele.html">pythtb.models.fu_kane_mele</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../usage.html" class="nav-link">Usage</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">pythtb.Bloch</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="pythtb-bloch">
<h1>pythtb.Bloch<a class="headerlink" href="#pythtb-bloch" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="pythtb.Bloch">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pythtb.</span></span><span class="sig-name descname"><span class="pre">Bloch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">param_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch" title="Link to this definition">#</a></dt>
<dd><p>Class for storing and manipulating Bloch wavefunctions.</p>
<p>This is a subclass of WFArray designed specifically for Bloch wavefunctions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="pythtb.TBModel.html#pythtb.TBModel" title="pythtb.TBModel"><em>TBModel</em></a>) – The tight-binding model associated with these Bloch wavefunctions.</p></li>
<li><p><strong>param_dims</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – The dimensions of the parameter space (k-space and/or adiabatic parameters).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">param_dims</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="pythtb.TBModel.html#pythtb.TBModel" title="pythtb.tb_model.TBModel"><em>TBModel</em></a>)</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__delattr__</span></code>(name, /)</p></td>
<td><p>Implement delattr(self, name).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__dir__</span></code>()</p></td>
<td><p>Default dir() implementation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__eq__</span></code>(value, /)</p></td>
<td><p>Return self==value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__format__</span></code>(format_spec, /)</p></td>
<td><p>Default object formatter.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__ge__</span></code>(value, /)</p></td>
<td><p>Return self&gt;=value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getattribute__</span></code>(name, /)</p></td>
<td><p>Return getattr(self, name).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getitem__</span></code>(key)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__getstate__</span></code>()</p></td>
<td><p>Helper for pickle.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__gt__</span></code>(value, /)</p></td>
<td><p>Return self&gt;value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__hash__</span></code>()</p></td>
<td><p>Return hash(self).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.__init__" title="pythtb.Bloch.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(model, *param_dims)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init_subclass__</span></code></p></td>
<td><p>This method is called when a class is subclassed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__le__</span></code>(value, /)</p></td>
<td><p>Return self&lt;=value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__lt__</span></code>(value, /)</p></td>
<td><p>Return self&lt;value.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__ne__</span></code>(value, /)</p></td>
<td><p>Return self!=value.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__new__</span></code>(*args, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__reduce__</span></code>()</p></td>
<td><p>Helper for pickle.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__reduce_ex__</span></code>(protocol, /)</p></td>
<td><p>Helper for pickle.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__repr__</span></code>()</p></td>
<td><p>Return repr(self).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__setattr__</span></code>(name, value, /)</p></td>
<td><p>Implement setattr(self, name, value).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__setitem__</span></code>(key, value)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__sizeof__</span></code>()</p></td>
<td><p>Size of object in memory, in bytes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__str__</span></code>()</p></td>
<td><p>Return str(self).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__subclasshook__</span></code></p></td>
<td><p>Abstract classes can override this to customize issubclass().</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_apply_phase</span></code>(wfs[, inverse])</p></td>
<td><p>Change between cell periodic and Bloch wfs by multiplying exp(pm i k .</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_check_key</span></code>(key)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_get_self_overlap_mat</span></code>()</p></td>
<td><p>Compute the overlap matrix of the cell periodic eigenstates.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">_set_projectors</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.berry_curv" title="pythtb.Bloch.berry_curv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">berry_curv</span></code></a>([dirs, state_idx, non_abelian, ...])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">berry_flux</span></code>([state_idx, plane, abelian])</p></td>
<td><p>Berry flux tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.berry_flux_plaq" title="pythtb.Bloch.berry_flux_plaq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">berry_flux_plaq</span></code></a>([state_idx, non_abelian])</p></td>
<td><p>Compute fluxes on a two-dimensional plane of states.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.berry_loop" title="pythtb.Bloch.berry_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">berry_loop</span></code></a>(wfs_loop[, evals])</p></td>
<td><p>Berry phase along a one-dimensional loop of wavefunctions.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">berry_phase</span></code>([occ, dir, contin, berry_evals])</p></td>
<td><p>Berry phase along a given array direction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.chern_num" title="pythtb.Bloch.chern_num"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chern_num</span></code></a>([dirs, band_idxs])</p></td>
<td><p>Computes the Chern number in the specified plane.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">choose_states</span></code>(subset)</p></td>
<td><p>Create a new <em>WFArray</em> object containing a subset of the states in the original one.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">empty_like</span></code>([nstates])</p></td>
<td><p>Create a new empty <em>WFArray</em> object based on the original.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.get_Bloch_Ham" title="pythtb.Bloch.get_Bloch_Ham"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_Bloch_Ham</span></code></a>()</p></td>
<td><p>Returns the Bloch Hamiltonian of the model defined over the semi-full k-mesh.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bloch_states</span></code>([flatten_spin])</p></td>
<td><p>Returns Bloch and cell-periodic states from the WFArray.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.get_energies" title="pythtb.Bloch.get_energies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_energies</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.get_links" title="pythtb.Bloch.get_links"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_links</span></code></a>(state_idx)</p></td>
<td><p>Compute the overlap links (unitary matrices) for the wavefunctions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.get_nbr_projector" title="pythtb.Bloch.get_nbr_projector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_nbr_projector</span></code></a>([return_Q])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.get_overlap_mat" title="pythtb.Bloch.get_overlap_mat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_overlap_mat</span></code></a>()</p></td>
<td><p>Returns overlap matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.get_proj_ham" title="pythtb.Bloch.get_proj_ham"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_proj_ham</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.get_projector" title="pythtb.Bloch.get_projector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_projector</span></code></a>([return_Q])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_projectors</span></code>([return_Q])</p></td>
<td><p>Returns the band projectors associated with the states in the WFArray.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.get_states" title="pythtb.Bloch.get_states"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_states</span></code></a>([flatten_spin])</p></td>
<td><p>Returns dictionary containing Bloch and cell-periodic eigenstates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.get_wf_axes" title="pythtb.Bloch.get_wf_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_wf_axes</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">impose_loop</span></code>(mesh_dir)</p></td>
<td><p>Impose a loop condition along a given mesh direction.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">impose_pbc</span></code>(mesh_dir, k_dir)</p></td>
<td><p>Impose periodic boundary conditions on the WFArray.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.interp_energy" title="pythtb.Bloch.interp_energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interp_energy</span></code></a>(k_path[, return_eigvecs])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.interp_op" title="pythtb.Bloch.interp_op"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interp_op</span></code></a>(O_k, k_path[, plaq])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.omega_til" title="pythtb.Bloch.omega_til"><code class="xref py py-obj docutils literal notranslate"><span class="pre">omega_til</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">position_expectation</span></code>(k_idx, occ, dir)</p></td>
<td><p>Position expectation value for a given k-point and set of states.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">position_hwf</span></code>(k_idx, occ, dir[, hwf_evec, basis])</p></td>
<td><p>Eigenvalues and eigenvectors of the position operator in a given basis.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">position_matrix</span></code>(k_idx, occ, dir)</p></td>
<td><p>Position matrix for a given k-point and set of states.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.set_Bloch_ham" title="pythtb.Bloch.set_Bloch_ham"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_Bloch_ham</span></code></a>([lambda_vals, model_fxn])</p></td>
<td><p>Set the Bloch Hamiltonian for the wavefunctions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.set_pbc_lam" title="pythtb.Bloch.set_pbc_lam"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_pbc_lam</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.set_wfs" title="pythtb.Bloch.set_wfs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_wfs</span></code></a>(wfs[, cell_periodic, ...])</p></td>
<td><p>Sets the Bloch and cell-periodic eigenstates as class attributes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_k_mesh</span></code>([lambda_idx, auto_detect_pbc])</p></td>
<td><p>Solve the Hamiltonian on the k-mesh for a given parameter slice.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.solve_model" title="pythtb.Bloch.solve_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_model</span></code></a>([lambda_vals, model_fxn])</p></td>
<td><p>Solves for the eigenstates of the Bloch Hamiltonian defined by the model over a semi-full k-mesh, e.g. in 3D reduced coordinates {k = [kx, ky, kz] | k_i in [0, 1)}.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_on_grid</span></code>([start_k])</p></td>
<td><p>Solve a tight-binding model on a regular mesh of k-points.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_on_one_point</span></code>(kpt, mesh_indices)</p></td>
<td><p>Solve a tight-binding model on a single k-point.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.solve_on_path" title="pythtb.Bloch.solve_on_path"><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve_on_path</span></code></a>(k_arr)</p></td>
<td><p>Solves on model passed when initialized.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.trace_metric" title="pythtb.Bloch.trace_metric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trace_metric</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pythtb.Bloch.wilson_loop" title="pythtb.Bloch.wilson_loop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wilson_loop</span></code></a>(wfs_loop[, evals])</p></td>
<td><p>Compute Wilson loop unitary matrix and its eigenvalues for multiband Berry phases.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Attributes</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__annotations__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__dict__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__doc__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__module__</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__weakref__</span></code></p></td>
<td><p>list of weak references to the object</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dim_mesh</span></code></p></td>
<td><p>The number of dimensions of the <em>WFArray</em> object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">energies</span></code></p></td>
<td><p>Returns the energies of the states stored in the <em>WFArray</em>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">flat_k_mesh</span></code></p></td>
<td><p>Returns a flattened version of the k-mesh used in the <em>WFArray</em>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">k_mesh</span></code></p></td>
<td><p>Returns the KMesh object associated with the <em>WFArray</em>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">loop_axes</span></code></p></td>
<td><p>The axes along which loops are imposed.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mesh_size</span></code></p></td>
<td><p>The mesh dimensions of the <em>WFArray</em> object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></p></td>
<td><p>The underlying TBModel object associated with the <em>WFArray</em>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">norb</span></code></p></td>
<td><p>The number of orbitals stored in the <em>WFArray</em> object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nspin</span></code></p></td>
<td><p>The number of spin components stored in the <em>WFArray</em> object.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">nstates</span></code></p></td>
<td><p>The number of states (or bands) stored in the <em>WFArray</em> object.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">param_path</span></code></p></td>
<td><p>The parameter path (e.g., k-points) along which the model was solved.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pbc_axes</span></code></p></td>
<td><p>The axes along which periodic boundary conditions are imposed.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.psi_wfs" title="pythtb.Bloch.psi_wfs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psi_wfs</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></p></td>
<td><p>The shape of the wavefunction array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pythtb.Bloch.u_wfs" title="pythtb.Bloch.u_wfs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u_wfs</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">wfs</span></code></p></td>
<td><p>The wavefunctions stored in the <em>WFArray</em> object.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="pythtb.Bloch.u_wfs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">u_wfs</span></span><a class="headerlink" href="#pythtb.Bloch.u_wfs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pythtb.Bloch.psi_wfs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">psi_wfs</span></span><a class="headerlink" href="#pythtb.Bloch.psi_wfs" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.get_wf_axes">
<span class="sig-name descname"><span class="pre">get_wf_axes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.get_wf_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.get_wf_axes" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.set_pbc_lam">
<span class="sig-name descname"><span class="pre">set_pbc_lam</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.set_pbc_lam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.set_pbc_lam" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.set_Bloch_ham">
<span class="sig-name descname"><span class="pre">set_Bloch_ham</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_vals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_fxn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.set_Bloch_ham"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.set_Bloch_ham" title="Link to this definition">#</a></dt>
<dd><p>Set the Bloch Hamiltonian for the wavefunctions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lambda_vals</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of parameter values for the adiabatic evolution.</p></li>
<li><p><strong>model_fxn</strong> (<em>function</em><em>, </em><em>optional</em>) – A function that returns a model given a set of parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.solve_model">
<span class="sig-name descname"><span class="pre">solve_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambda_vals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_fxn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.solve_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.solve_model" title="Link to this definition">#</a></dt>
<dd><p>Solves for the eigenstates of the Bloch Hamiltonian defined by the model over a semi-full
k-mesh, e.g. in 3D reduced coordinates {k = [kx, ky, kz] | k_i in [0, 1)}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>dict</strong> (<em>lambda_vals</em>) – Dictionary of parameter values for adiabatic evolution. Each key corresponds to
a varying parameter and the values are arrays</p></li>
<li><p><strong>optional</strong><strong>)</strong> – Dictionary of parameter values for adiabatic evolution. Each key corresponds to
a varying parameter and the values are arrays</p></li>
<li><p><strong>(</strong><strong>function</strong> (<em>model_fxn</em>) – A function that returns a model given a set of parameters.</p></li>
<li><p><strong>optional</strong><strong>)</strong> – A function that returns a model given a set of parameters.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.solve_on_path">
<span class="sig-name descname"><span class="pre">solve_on_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.solve_on_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.solve_on_path" title="Link to this definition">#</a></dt>
<dd><p>Solves on model passed when initialized. Not suitable for
adiabatic parameters in the model beyond k.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.get_states">
<span class="sig-name descname"><span class="pre">get_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flatten_spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.get_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.get_states" title="Link to this definition">#</a></dt>
<dd><p>Returns dictionary containing Bloch and cell-periodic eigenstates.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.get_projector">
<span class="sig-name descname"><span class="pre">get_projector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_Q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.get_projector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.get_projector" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.get_nbr_projector">
<span class="sig-name descname"><span class="pre">get_nbr_projector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_Q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.get_nbr_projector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.get_nbr_projector" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.get_energies">
<span class="sig-name descname"><span class="pre">get_energies</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.get_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.get_energies" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.get_Bloch_Ham">
<span class="sig-name descname"><span class="pre">get_Bloch_Ham</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.get_Bloch_Ham"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.get_Bloch_Ham" title="Link to this definition">#</a></dt>
<dd><p>Returns the Bloch Hamiltonian of the model defined over the semi-full k-mesh.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.get_overlap_mat">
<span class="sig-name descname"><span class="pre">get_overlap_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.get_overlap_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.get_overlap_mat" title="Link to this definition">#</a></dt>
<dd><p>Returns overlap matrix.</p>
<p>Overlap matrix defined as M_{n,m,k,b} = &lt;u_{n, k} | u_{m, k+b}&gt;</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.set_wfs">
<span class="sig-name descname"><span class="pre">set_wfs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wfs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin_flattened</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_projectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.set_wfs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.set_wfs" title="Link to this definition">#</a></dt>
<dd><p>Sets the Bloch and cell-periodic eigenstates as class attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wfs</strong> (<em>np.ndarray</em>) – Bloch (or cell-periodic) eigenstates defined on a semi-full k-mesh corresponding
to nks passed during class instantiation. The mesh is assumed to exlude the
endpoints, e.g. in reduced coordinates {k = [kx, ky, kz] | k_i in [0, 1)}.</p></li>
<li><p><strong>cell_periodic</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.wilson_loop">
<span class="sig-name descname"><span class="pre">wilson_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wfs_loop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.wilson_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.wilson_loop" title="Link to this definition">#</a></dt>
<dd><p>Compute Wilson loop unitary matrix and its eigenvalues for multiband Berry phases.</p>
<p>Multiband Berry phases always returns numbers between -pi and pi.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wfs_loop</strong> (<em>np.ndarray</em>) – Has format [loop_idx, band, orbital, spin] and loop has to be one dimensional.
Assumes that first and last loop-point are the same. Therefore if
there are n wavefunctions in total, will calculate phase along n-1
links only!</p></li>
<li><p><strong>berry_evals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If berry_evals is True then will compute phases for
individual states, these corresponds to 1d hybrid Wannier
function centers. Otherwise just return one number, Berry phase.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.berry_loop">
<span class="sig-name descname"><span class="pre">berry_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wfs_loop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.berry_loop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.berry_loop" title="Link to this definition">#</a></dt>
<dd><p>Berry phase along a one-dimensional loop of wavefunctions.</p>
<p>The Berry phase is computed as the logarithm of the determinant
of the product of the overlap matrices between neighboring
wavefunctions in the loop. In otherwords, the Berry phase is
given by the formula:</p>
<div class="math notranslate nohighlight">
\[\phi = -\text{Im} \ln \det U_{\rm Wilson}\]</div>
<p>where <span class="math notranslate nohighlight">\(U\)</span> is the Wilson loop unitary matrix obtained from
<a class="reference internal" href="#pythtb.Bloch.wilson_loop" title="pythtb.Bloch.wilson_loop"><code class="xref py py-func docutils literal notranslate"><span class="pre">wilson_loop()</span></code></a>. The Berry phase is returned as a
single number, which is the total Berry phase for the loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wfs_loop</strong> (<em>np.ndarray</em>) – Wavefunctions in the loop, with shape <cite>[loop_idx, band, orbital, spin]</cite>.
The first and last points in the loop are assumed to be the same.</p></li>
<li><p><strong>evals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Default is <cite>False</cite>. If <cite>True</cite>, will return the eigenvalues
of the Wilson loop unitary matrix instead of the total Berry phase.
The eigenvalues correspond to the “maximally localized Wannier centers” or
“Wilson loop eigenvalues”. If False, will return the total
Berry phase for the loop.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If evals is True, returns the eigenvalues of the Wilson loop
unitary matrix, which are the Berry phases for each band.
If evals is False, returns the total Berry phase for the loop,
which is a single number.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">berry_phase()</span></code>, <a class="reference internal" href="#pythtb.Bloch.get_links" title="pythtb.Bloch.get_links"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_links()</span></code></a>, <a class="reference internal" href="#pythtb.Bloch.wilson_loop" title="pythtb.Bloch.wilson_loop"><code class="xref py py-func docutils literal notranslate"><span class="pre">wilson_loop()</span></code></a></p>
<dl class="simple">
<dt><a class="reference internal" href="../formalism.html#formalism"><span class="std std-ref">Formalism</span></a></dt><dd><p>Section 4.5</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The loop is assumed to be one-dimensional, meaning that the first
and last points in the loop are assumed to be the same, and the wavefunctions
at these points are also assumed to be the same. The wavefunctions in the loop
should be ordered such that the first point corresponds to the first wavefunction,
the second point to the second wavefunction, and so on, up to the last point,
which corresponds to the last wavefunction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.get_links">
<span class="sig-name descname"><span class="pre">get_links</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.get_links"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.get_links" title="Link to this definition">#</a></dt>
<dd><p>Compute the overlap links (unitary matrices) for the wavefunctions.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<p>The overlap links for the wavefunctions in the <cite>WFArray</cite> object
along a given direction are defined as the unitary part of the overlap
between the wavefunctions and their neighbors in the forward direction along each
mesh directions. Specifcally, the overlap matrices are computed as</p>
<div class="math notranslate nohighlight">
\[M_{nm}^{\mu}(\mathbf{k}) = \langle u_{nk} | u_{m, k + \delta k_{\mu}} \rangle\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> is the direction along which the link is computed, and
<span class="math notranslate nohighlight">\(\delta k_{\mu}\)</span> is the shift in the wavevector along that direction. The
<span class="math notranslate nohighlight">\(k\)</span> here could be a point in an arbitrary parameter mesh. The unitary link that
is returned by the function is obtained through the singular value decomposition
(SVD) of the overlap matrix <span class="math notranslate nohighlight">\(M^{\mu}(\mathbf{k}) = V^{\mu} \Sigma^{\mu} (W^{\mu})^\dagger\)</span>
as,</p>
<div class="math notranslate nohighlight">
\[U^{\mu}(\mathbf{k}) = V^{\mu} (W^{\mu})^\dagger\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The neighbor at the boundary is defined with periodic boundary conditions by default.
In most cases, this means that the last point in the mesh of <span class="math notranslate nohighlight">\(U^{\mu}(\mathbf{k})\)</span>
along each direction should be disregarded (see Notes for further details).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Index or indices of the states for which to compute the links.
If an integer is provided, only that state will be considered.
If a list is provided, links for all specified states will be computed.</p></li>
<li><p><strong>dirs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – List of directions along which to compute the links.
If not provided, links will be computed for all directions in the mesh.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of shape [dim, nk1, nk2, …, nkd, n_states, n_states]
where dim is the number of dimensions of the mesh,
(nk1, nk2, …, nkd) are the sizes of the mesh in each dimension,
and n_states is the number of states in the <em>WFArray</em> object. The first
axis corresponds to <span class="math notranslate nohighlight">\(\mu\)</span>, the last two axes are the matrix elements,
and the remaining axes are the mesh points.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>U_forward (np.ndarray)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The last points in the mesh of <cite>U_forward</cite> should be treated carefully. Periodic boundary
conditions are always implied here, so that the 0’th wavefunction is the forward neighbor of
the last wavefunction (-1’st element) along each direction. If the <cite>WFArray</cite> mesh has already
been defined with periodic boundary conditions, with either <code class="xref py py-func docutils literal notranslate"><span class="pre">impose_pbc()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">impose_loop()</span></code>,
then the last points are identified with the first points. This means the overlap links at the boundary
should be disregarded, since the overlap is not between neighbors. If the last and first wavefunctions
are not neighbors, then the forward neighbor at the boundary is undefined and the value
of <span class="math notranslate nohighlight">\(U_{nk}^{\mu}\)</span> at the boundary can again be disregarded. The only time these points should not be
disregarded is when the last and first wavefunctions are truly neighbors, which would only happen if
the wavefunctions on the mesh were manually populated that way.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.berry_flux_plaq">
<span class="sig-name descname"><span class="pre">berry_flux_plaq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_abelian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.berry_flux_plaq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.berry_flux_plaq" title="Link to this definition">#</a></dt>
<dd><p>Compute fluxes on a two-dimensional plane of states.</p>
<p>For a given set of states, returns the band summed Berry curvature
rank-2 tensor for all combinations of surfaces in reciprocal space.
By convention, the Berry curvature is reported at the point where the loop
started, which is the lower left corner of a plaquette.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.berry_curv">
<span class="sig-name descname"><span class="pre">berry_curv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_abelian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_lam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Kubo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.berry_curv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.berry_curv" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.chern_num">
<span class="sig-name descname"><span class="pre">chern_num</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_idxs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.chern_num"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.chern_num" title="Link to this definition">#</a></dt>
<dd><p>Computes the Chern number in the specified plane.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.0.0.</span></p>
</div>
<p>The Chern number is computed as the integral of the Berry flux
over the specified plane, divided by <span class="math notranslate nohighlight">\(2 \pi\)</span>.</p>
<div class="math notranslate nohighlight">
\[C = \frac{1}{2\pi} \sum_{\mathbf{k}_{\mu}, \mathbf{k}_{\nu}} F_{\mu\nu}(\mathbf{k}).\]</div>
<p>The plane <span class="math notranslate nohighlight">\((\mu, \nu)\)</span> is specified by <cite>plane</cite>, a tuple of two indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plane</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – A tuple of two indices specifying the plane in which the Chern number is computed.
The indices should be between 0 and the number of mesh dimensions minus 1.
If None, the Chern number is computed for the first two dimensions of the mesh.</p></li>
<li><p><strong>state_idx</strong> (<em>array-like</em><em>, </em><em>optional array</em>) – Indices of states to be included in the Chern number calculation.
If None, all states are included. None by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>chern</strong> – In the two-dimensional case, the result
will be a floating point approximation of the integer Chern number
for that plane. In a higher-dimensional space, the Chern number
is computed for each 2D slice of the higher-dimensional space.
E.g., the shape of the returned array is <cite>(nk3, …, nkd)</cite> if the plane is
<cite>(0, 1)</cite>, where <cite>(nk3, …, nkd)</cite> are the sizes of the mesh in the remaining
dimensions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Suppose we have a <cite>WFArray</cite> mesh in three-dimensional space
of shape <cite>(nk1, nk2, nk3)</cite>. We can compute the Chern number for the
<cite>(0, 1)</cite> plane as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wfs</span> <span class="o">=</span> <span class="n">WFArray</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wfs</span><span class="o">.</span><span class="n">solve_on_grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chern</span> <span class="o">=</span> <span class="n">wfs</span><span class="o">.</span><span class="n">chern_num</span><span class="p">(</span><span class="n">plane</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">state_idx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_occ</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">chern</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(12,)  # shape of the Chern number array</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.trace_metric">
<span class="sig-name descname"><span class="pre">trace_metric</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.trace_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.trace_metric" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.omega_til">
<span class="sig-name descname"><span class="pre">omega_til</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.omega_til"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.omega_til" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.interp_op">
<span class="sig-name descname"><span class="pre">interp_op</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">O_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plaq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.interp_op"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.interp_op" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.interp_energy">
<span class="sig-name descname"><span class="pre">interp_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_eigvecs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.interp_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.interp_energy" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pythtb.Bloch.get_proj_ham">
<span class="sig-name descname"><span class="pre">get_proj_ham</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pythtb/bloch.html#Bloch.get_proj_ham"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pythtb.Bloch.get_proj_ham" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="pythtb.Wannier.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">pythtb.Wannier</p>
      </div>
    </a>
    <a class="right-next"
       href="pythtb.plotting.plot_bands.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">pythtb.plotting.plot_bands</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch"><code class="docutils literal notranslate"><span class="pre">Bloch</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.__init__"><code class="docutils literal notranslate"><span class="pre">Bloch.__init__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.u_wfs"><code class="docutils literal notranslate"><span class="pre">Bloch.u_wfs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.psi_wfs"><code class="docutils literal notranslate"><span class="pre">Bloch.psi_wfs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.get_wf_axes"><code class="docutils literal notranslate"><span class="pre">Bloch.get_wf_axes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.set_pbc_lam"><code class="docutils literal notranslate"><span class="pre">Bloch.set_pbc_lam()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.set_Bloch_ham"><code class="docutils literal notranslate"><span class="pre">Bloch.set_Bloch_ham()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.solve_model"><code class="docutils literal notranslate"><span class="pre">Bloch.solve_model()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.solve_on_path"><code class="docutils literal notranslate"><span class="pre">Bloch.solve_on_path()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.get_states"><code class="docutils literal notranslate"><span class="pre">Bloch.get_states()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.get_projector"><code class="docutils literal notranslate"><span class="pre">Bloch.get_projector()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.get_nbr_projector"><code class="docutils literal notranslate"><span class="pre">Bloch.get_nbr_projector()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.get_energies"><code class="docutils literal notranslate"><span class="pre">Bloch.get_energies()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.get_Bloch_Ham"><code class="docutils literal notranslate"><span class="pre">Bloch.get_Bloch_Ham()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.get_overlap_mat"><code class="docutils literal notranslate"><span class="pre">Bloch.get_overlap_mat()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.set_wfs"><code class="docutils literal notranslate"><span class="pre">Bloch.set_wfs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.wilson_loop"><code class="docutils literal notranslate"><span class="pre">Bloch.wilson_loop()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.berry_loop"><code class="docutils literal notranslate"><span class="pre">Bloch.berry_loop()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.get_links"><code class="docutils literal notranslate"><span class="pre">Bloch.get_links()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.berry_flux_plaq"><code class="docutils literal notranslate"><span class="pre">Bloch.berry_flux_plaq()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.berry_curv"><code class="docutils literal notranslate"><span class="pre">Bloch.berry_curv()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.chern_num"><code class="docutils literal notranslate"><span class="pre">Bloch.chern_num()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.trace_metric"><code class="docutils literal notranslate"><span class="pre">Bloch.trace_metric()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.omega_til"><code class="docutils literal notranslate"><span class="pre">Bloch.omega_til()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.interp_op"><code class="docutils literal notranslate"><span class="pre">Bloch.interp_op()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.interp_energy"><code class="docutils literal notranslate"><span class="pre">Bloch.interp_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pythtb.Bloch.get_proj_ham"><code class="docutils literal notranslate"><span class="pre">Bloch.get_proj_ham()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, Trey Cole, Sinisa Coh, and David Vanderbilt.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>